<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>First Page</title>
    <url>/2023/11/01/First-Page-en/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>tc</category>
      </categories>
      <tags>
        <tag>tt</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬ä¸€æ¬¡æäº¤</title>
    <url>/2023/11/01/First-Page-cn/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>tc</category>
      </categories>
      <tags>
        <tag>tt</tag>
      </tags>
  </entry>
  <entry>
    <title>PKU-Geekgame-3rd</title>
    <url>/2023/11/01/PKU-Geekgame-3rd/</url>
    <content><![CDATA[<h1 id="å†™åœ¨æœ€å‰é¢"><a href="#å†™åœ¨æœ€å‰é¢" class="headerlink" title="å†™åœ¨æœ€å‰é¢"></a>å†™åœ¨æœ€å‰é¢</h1><p>è¿™æ˜¯æˆ‘çš„ç¬¬ä¸‰å±ŠåŒ—äº¬å¤§å­¦ä¿¡æ¯å®‰å…¨ç»¼åˆèƒ½åŠ›ç«èµ›å‚èµ›è®°å½•ã€‚10æœˆ6æ—¥çŸ¥é“äº†å­¦æ ¡æœ‰è¿™ä¸ªæ¯”èµ›ï¼Œè¿™æ˜¯<a href="https://geekgame.pku.edu.cn">æ¯”èµ›çš„å®˜ç½‘</a>ã€‚è™½ç„¶å¯¹ç½‘ç»œå®‰å…¨ä¹‹å‰æ²¡æœ‰ç³»ç»Ÿå­¦ä¹ è¿‡ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•å®è·µï¼Œä½†è¯¾ä½™çš„æ—¶å€™è‡ªå­¦è¿‡è®¡ç®—æœºç³»ç»Ÿå¯¼è®ºå’Œæ“ä½œç³»ç»Ÿçš„ä¸€äº›ç†è®ºï¼Œå°±æ¥å‚åŠ è¿™ä¸ªæ¯”èµ›äº†ã€‚æ¯”èµ›ä¸ºæœŸä¸€å‘¨ï¼Œ10æœˆ13æ—¥18:00-10æœˆ20æ—¥18:00ï¼Œä¸¤ä¸ªé˜¶æ®µç»“æŸåæœ€ç»ˆæ‹¿äº†æ ¡å†…çš„38åï¼Œä¸‹é¢æ˜¯è¿™æ¬¡æ¯”èµ›æˆ‘çš„writeupã€‚</p>
<h1 id="ä¸€çœ¼ç›¯å¸§ï¼ˆé€šè¿‡ï¼‰"><a href="#ä¸€çœ¼ç›¯å¸§ï¼ˆé€šè¿‡ï¼‰" class="headerlink" title="ä¸€çœ¼ç›¯å¸§ï¼ˆé€šè¿‡ï¼‰"></a>ä¸€çœ¼ç›¯å¸§ï¼ˆé€šè¿‡ï¼‰</h1><p>(# prob23-signin)</p>
<p>gifæ–‡ä»¶ä¸­å¼€å¤´ä¸ºsyntï¼Œåœ¨æœç´¢å¼•æ“ä¸­æŸ¥æ‰¾ROT13è§£ç ï¼Œè¾“å…¥æ–‡æœ¬è§£ç å³å¯ã€‚</p>
<h1 id="å°åŒ—é—®ç­”ï¼ˆé€šè¿‡ï¼‰"><a href="#å°åŒ—é—®ç­”ï¼ˆé€šè¿‡ï¼‰" class="headerlink" title="å°åŒ—é—®ç­”ï¼ˆé€šè¿‡ï¼‰"></a>å°åŒ—é—®ç­”ï¼ˆé€šè¿‡ï¼‰</h1><p>(# prob18-trivia)</p>
<p>1ã€åœ¨hpc.pku.edu.cnçš„ä¸Šæœºæµç¨‹ä¸­ï¼Œæ‰¾åˆ°ã€4ã€‘æäº¤ä½œä¸šä¸­ï¼Œæœ‰ã€4.1ã€‘sbatchæäº¤ä½œä¸šå’Œã€4.2ã€‘sallocäº¤äº’è¿è¡Œä½œä¸šä¸¤ç§</p>
<p>2ã€æ‰¾åˆ°GitHubä¸­å°ç±³å¼€æºæ‰‹æœºå†…æ ¸<a href="https://github.com/MiCode/Xiaomi_Kernel_OpenSource">ä»“åº“</a>ã€‚æ‰¾åˆ°Redmi K60 Ultraçš„åˆ†æ”¯ï¼Œåœ¨åˆ†æ”¯å†…çš„Makefileæ–‡ä»¶å¯ä»¥æ‰¾åˆ°</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">VERSION = 5</span><br><span class="line">PATCHLEVEL = 15</span><br><span class="line">SUBLEVEL = 78</span><br></pre></td></tr></table></figure>
<p>è¿æ¥èµ·æ¥å°±æ˜¯ç‰ˆæœ¬å·ã€‚</p>
<p>3ã€åœ¨GitHubä¸Šå¯ä»¥æ‰¾åˆ°è‹¹æœå†…éƒ¨è¯†åˆ«çš„<a href="https://gist.github.com/adamawolf/3048717">æ±‡æ€»</a>ã€‚å…¶ä¸­æœ‰</p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">Watch6,14 : Apple Watch Series 8 41mm case (GPS)</span><br><span class="line">Watch6,15 : Apple Watch Series 8 45mm case (GPS)</span><br><span class="line">Watch6,16 : Apple Watch Series 8 41mm case (GPS+Cellular)</span><br><span class="line">Watch6,17 : Apple Watch Series 8 45mm case (GPS+Cellular)</span><br></pre></td></tr></table></figure>
<p>4ã€æ‰¾åˆ°PKU GeekGameçš„å¼€æºåç«¯(<a href="https://github.com/PKU-GeekGame/gs-backend">GitHub - PKU-GeekGame/gs-backend: Project Guiding Star: The Backend</a>)ã€‚åœ¨æ‰€æœ‰æ–‡ä»¶ä¸­æœç´¢â€œæ˜µç§°â€ï¼Œæ‰¾åˆ°åœ¨src/store/user_profile_store.pyä¸‹æœ‰å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@classmethod</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_deep_val_nickname</span>(<span class="params">cls, name: <span class="built_in">str</span></span>) -&gt; <span class="type">Optional</span>[<span class="built_in">str</span>]:</span><br><span class="line">    all_whitespace = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">if</span> c <span class="keyword">in</span> cls.DISALLOWED_CHARS:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">f&#x27;æ˜µç§°ä¸­ä¸èƒ½åŒ…å«å­—ç¬¦ <span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">ord</span>(c))&#125;</span>&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> cls.WHITESPACE_CHARS:</span><br><span class="line">            all_whitespace = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> all_whitespace:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;æ˜µç§°ä¸èƒ½å…¨ä¸ºç©ºæ ¼&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸ªäººç”µè„‘ä¸Šè¿è¡Œå‡½æ•°ä»¥åŠæ–‡ä»¶ä¸­ç›¸å…³çš„å‡½æ•°ï¼Œå¾—åˆ°ç»“æœåæäº¤ï¼Œä½†æ˜¯ç»“æœä¸å¯¹ï¼Œåå‘ç°åœ¨Readmeä¸­ï¼Œæœ‰</p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line"><span class="bullet">-</span> Install Python (â‰¥3.8)</span><br></pre></td></tr></table></figure>
<p>è€ƒè™‘å¹³å°ä¸ºè¿‡å»å¼€å‘ï¼Œä»3.8å¼€å§‹å¾€åå°è¯•ï¼Œæœ€ç»ˆç»“æœä¸º3.8å¹³å°çš„ç»“æœã€‚</p>
<p>5ã€<a href="https://web.archive.org/">web.archive.org</a>å¯ä»¥è®¿é—®è¿‡å»çš„ç½‘é¡µå¿«ç…§ã€‚éœ€è¦ä½¿ç”¨bilibili.usçš„åŸŸå</p>
<p>6ã€æŸ¥è¯¢èµåŠ©å•†å¯¹åº”çš„æ´»åŠ¨ï¼Œæ‰¾åˆ°äº†<a href="http://www.iaspbo.com.cn">2023å¹´å¢æ£®å ¡iaspä¸–ç•Œå¤§ä¼š</a>ï¼Œå› æ­¤è¿™æ˜¯å¢æ£®å ¡çš„å»ºç­‘ã€‚æœç´¢å¢æ£®å ¡è‘—åå»ºç­‘ï¼Œæ¯”å¯¹å›¾ç‰‡ï¼Œå¯ä»¥çŸ¥é“æ˜¯å¢æ£®å ¡éŸ³ä¹å…ã€‚</p>
<h1 id="Zå…¬å¸çš„æœåŠ¡å™¨ï¼ˆflag1ï¼‰"><a href="#Zå…¬å¸çš„æœåŠ¡å™¨ï¼ˆflag1ï¼‰" class="headerlink" title="Zå…¬å¸çš„æœåŠ¡å™¨ï¼ˆflag1ï¼‰"></a>Zå…¬å¸çš„æœåŠ¡å™¨ï¼ˆflag1ï¼‰</h1><p>(# prob05-zserver)</p>
<p>åœ¨ç½‘é¡µç»ˆç«¯å’Œæœ¬åœ°è¿æ¥ï¼Œå‘ç°ä¼šè¿”å›ï¿½*B00000000000000ã€‚æœç´¢å¯ä»¥å‘ç°åœ¨ä½¿ç”¨lszrzçš„szã€rzå‘½ä»¤æ—¶ä¼šæœ‰ç›¸å…³æŠ¥é”™å‘ç”Ÿã€‚ç¬¬ä¸€é˜¶æ®µæ—¶ï¼Œåœ¨Windowsç³»ç»Ÿä¸­ä½¿ç”¨xshellè¿›è¡Œè¿æ¥ï¼Œå‘ç°æ–‡ä»¶ä¸ä¼šæˆåŠŸä¸‹è½½ã€‚</p>
<p>ç¬¬äºŒé˜¶æ®µï¼Œåœ¨æœ¬åœ°ï¼ˆMacOSï¼‰é…ç½®zmodemçš„ç¯å¢ƒ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install lrzsz</span><br></pre></td></tr></table></figure>
<p>é…ç½®/iterm2-send-zmodem.sh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># iterm2-send-zmodem.sh</span></span><br><span class="line"></span><br><span class="line">FILE=`osascript -e <span class="string">&#x27;tell application &quot;iTerm&quot; to activate&#x27;</span> -e <span class="string">&#x27;tell application &quot;iTerm&quot; to set thefile to choose file with prompt &quot;Choose a file to send&quot;&#x27;</span> -e <span class="string">&quot;do shell script (\&quot;echo \&quot;&amp;(quoted form of POSIX path of thefile as Unicode text)&amp;\&quot;\&quot;)&quot;</span>`</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$FILE</span> = <span class="string">&quot;&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> Cancelled.</span><br><span class="line">    <span class="comment"># Send ZModem cancel</span></span><br><span class="line">    <span class="built_in">echo</span> -e \\x18\\x18\\x18\\x18\\x18</span><br><span class="line">    <span class="built_in">echo</span> \<span class="comment"># Cancelled transfer</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$FILE</span></span><br><span class="line">    /usr/local/bin/sz -e <span class="string">&quot;<span class="variable">$FILE</span>&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> \<span class="comment"># Received $FILE</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>å’Œiterm2-recv-zmodem.sh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># iterm2-recv-zmodem.sh</span></span><br><span class="line"></span><br><span class="line">FILE=`osascript -e <span class="string">&#x27;tell application &quot;iTerm&quot; to activate&#x27;</span> -e <span class="string">&#x27;tell application &quot;iTerm&quot; to set thefile to choose folder with prompt &quot;Choose a folder to place received files in&quot;&#x27;</span> -e <span class="string">&quot;do shell script (\&quot;echo \&quot;&amp;(quoted form of POSIX path of thefile as Unicode text)&amp;\&quot;\&quot;)&quot;</span>`</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$FILE</span> = <span class="string">&quot;&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> Cancelled.</span><br><span class="line">    <span class="comment"># Send ZModem cancel</span></span><br><span class="line">    <span class="built_in">echo</span> -e \\x18\\x18\\x18\\x18\\x18</span><br><span class="line">    <span class="built_in">echo</span> \<span class="comment"># Cancelled transfer</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$FILE</span></span><br><span class="line">    <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$FILE</span>&quot;</span></span><br><span class="line">    /usr/local/bin/rz -e</span><br><span class="line">    <span class="built_in">echo</span> \<span class="comment"># Received $FILE</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>è¿æ¥åé€‰æ‹©ä¸‹è½½åœ°å€å³å¯æˆåŠŸä¸‹è½½å¾—åˆ°falg.txtæ–‡ä»¶ã€‚</p>
<h1 id="åŸºæœ¬åŠŸï¼ˆé€šè¿‡ï¼‰"><a href="#åŸºæœ¬åŠŸï¼ˆé€šè¿‡ï¼‰" class="headerlink" title="åŸºæœ¬åŠŸï¼ˆé€šè¿‡ï¼‰"></a>åŸºæœ¬åŠŸï¼ˆé€šè¿‡ï¼‰</h1><p>(# prob24-password)</p>
<p>1ã€ç¬¬ä¸€ä¸ªå‹ç¼©åŒ…ä¸­æœ‰ä¸€ä¸ªå‹ç¼©æ–‡ä»¶chromedriver_linux64.zipï¼Œå¯ä»¥ç”¨æ˜æ–‡æ”»å‡»æ¥ç ´è§£å‹ç¼©æ–‡ä»¶ã€‚æ‰¾åˆ°è¿™ä¸ªå®é™…ä¸Šæ˜¯chromeæµè§ˆå™¨çš„é©±åŠ¨å™¨ï¼Œæ ¹æ®è¿™ä¸ªchromedriver_linux64.zipçš„CRCå€¼ï¼Œæ‰¾åˆ°å®Œå…¨ä¸€æ ·çš„æ–‡ä»¶å¯ä»¥<a href="https://chromedriver.storage.googleapis.com/83.0.4103.14/chromedriver_linux64.zip">ä¸‹è½½</a>ã€‚ç”¨GitHubä¸ŠLinuxå¹³å°çš„<a href="https://github.com/kimci86/bkcrack">bkcrack</a>å·¥å…·ï¼Œå¯ä»¥ç ´è§£zipæ–‡ä»¶çš„keyï¼Œç”¨keyå¾—åˆ°æ–°çš„æŒ‡å®šå¯†ç çš„å‹ç¼©åŒ…è§£å‹ã€‚</p>
<p>ç›¸å…³å‘½ä»¤ä¸º</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bkcrack -C challenge_1.zip -c chromedriver_linux64.zip -p chromedriver_linux64.zip</span><br><span class="line">bkcrack -C challenge_1.zip -k 9a9b3ae9 55ec8fe1 c7575174 -U new.zip 123</span><br></pre></td></tr></table></figure>
<p>è§£å‡ºæ­¤é¢˜æ—¶ä¸‹è½½äº†æ‰€æœ‰ç‰ˆæœ¬çš„é©±åŠ¨æ–‡ä»¶ï¼Œé€ä¸€æ¯”å¯¹å¯†é’¥å€¼åè§£å‡ºäº†keyå€¼ã€‚</p>
<p>2ã€ç¬¬äºŒä¸ªå‹ç¼©åŒ…æ˜¯pcapngæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æœ‰ä¸€éƒ¨åˆ†å­—èŠ‚æ˜¯å¯ä»¥ç¡®å®šçš„ï¼Œå‚è€ƒ<a href="https://pcapng.com">pcapngæ–‡ä»¶æ ¼å¼</a>ã€‚å°†<a href="https://pcapng.com/#SHB_BlockType">Block Type</a>ã€<a href="https://pcapng.com/#SHB_Version">Major Version</a>ã€<a href="https://pcapng.com/#SHB_SectionLength">Section Length</a>çš„å‰8ä½ä½œä¸ºæ˜æ–‡ã€‚</p>
<p>ç›¸å…³å‘½ä»¤ä¸º</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bkcrack -C challenge_2.zip -c flag2.pcapng -x 0 0a0d0d0a -x 12 01000000ffffffffffffffff</span><br><span class="line">bkcrack -C challenge_2.zip -k 9a9b3ae9 55ec8fe1 c7575174 -U 2.zip 123</span><br></pre></td></tr></table></figure>
<h1 id="Dark-Roomï¼ˆflag1ï¼‰"><a href="#Dark-Roomï¼ˆflag1ï¼‰" class="headerlink" title="Dark Roomï¼ˆflag1ï¼‰"></a>Dark Roomï¼ˆflag1ï¼‰</h1><p>(# prob16-darkroom)</p>
<p>æœ¬é¢˜çš„ç¬¬ä¸€ä¸ªflagéœ€è¦ä»¥117%çš„sanityé€šå…³å¯ä»¥è·å¾—flagã€‚</p>
<p>æ¸¸æˆä¸­éœ€è¦æ¢ç´¢åœ°å›¾å„ä¸ªä½ç½®çš„ç‰©å“ï¼Œç»è¿‡æŸ¥è¯¢æ¸¸æˆä¿®æ”¹å‰çš„æºç ï¼Œä»¥åŠå¯¹æ¸¸æˆçš„æ¢ç´¢ï¼Œè¿™æ˜¯æœ€å®¹æ˜“é€šå…³çš„ä¸€æ¡è·¯å¾„ï¼š</p>
<p>1ã€åœ¨åŒ—éƒ¨æ‰¾åˆ°é“œé’¥åŒ™</p>
<p>2ã€è·å¾—trinketï¼Œå¹¶ä½¿ç”¨</p>
<p>3ã€ç”¨é“œé’¥åŒ™å¼€é—¨</p>
<p>4ã€åˆ°è¾¾é¥®ç”¨å’–å•¡çš„ä½ç½®</p>
<p>5ã€åœ¨è¥¿å—è§’çš„åŒ—é¢è·å¾—é‡‘é’¥åŒ™</p>
<p>6ã€åœ¨è¥¿åŒ—è§’ç”¨é‡‘é’¥åŒ™å¼€é—¨</p>
<p>7ã€ï¼ˆæœ€å…³é”®ï¼‰åœ¨æ¸¸æˆä»»ä½•é˜¶æ®µï¼Œè¿ç»­helpä¸‰æ¬¡å¹¶åŠ åˆ°sanityï¼Œè¿™æ˜¯ç”±äºä¸ç”¨helpçš„æœ€ä½³é€šå…³sanityæ˜¯90%ï¼ŒhelpæˆåŠŸå¯ä»¥åŠ 9%ï¼ˆæºç æ¦‚ç‡20%ï¼‰ï¼Œå¤±è´¥ä¼šå‡å»6%æˆ–16%ï¼ˆæºç æ¦‚ç‡80%ï¼‰ï¼ŒçŒœæµ‹å®é™…æ¦‚ç‡å¯èƒ½ä¹Ÿæœ‰æ‰€æ”¹åŠ¨ã€‚</p>
<p>æœ¬äººå› è¿æ°”æ¯”è¾ƒå¥½ï¼Œåœ¨å°è¯•å‡ æ¬¡åå¼€å¤´è¿ç»­helpä¸‰æ¬¡æˆåŠŸï¼Œå³é€šè¿‡åç»­æœ€ä½³è·¯å¾„é€šå…³ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯ä»¥å†™ä¸€ä¸ªexpectè„šæœ¬è¿›è¡Œä¸æ–­å°è¯•ã€‚</p>
<h1 id="Emoji-Wordleï¼ˆé€šè¿‡ï¼‰"><a href="#Emoji-Wordleï¼ˆé€šè¿‡ï¼‰" class="headerlink" title="Emoji Wordleï¼ˆé€šè¿‡ï¼‰"></a>Emoji Wordleï¼ˆé€šè¿‡ï¼‰</h1><p>æœ¬é¢˜ä¸‰é—®è™½ç„¶å†…å®¹ä¸åŒï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ä¸€ä¸ªé€šç”¨pythonçˆ¬è™«è„šæœ¬è·å–ç­”æ¡ˆï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: user_agent,</span><br><span class="line">    <span class="string">&#x27;Cookie&#x27;</span>: cookie</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n_loop):</span><br><span class="line">    url = <span class="string">f&#x27;https://prob14.geekgame.pku.edu.cn/level3?guess=<span class="subst">&#123;guess&#125;</span>&#x27;</span></span><br><span class="line">    r = requests.get(url=url, headers=header)</span><br><span class="line">    html = r.text</span><br><span class="line">    <span class="comment"># print(html)</span></span><br><span class="line"></span><br><span class="line">    placeholder = re.findall(<span class="string">r&#x27;results\.push\(\&quot;(.*?)\&quot;\)&#x27;</span>, html)[<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># print(placeholder)</span></span><br><span class="line">    placeholder_array = np.array(<span class="built_in">list</span>(placeholder))</span><br><span class="line">    <span class="comment"># print(&quot;&quot;.join(placeholder_array))</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;ğŸŸ©&#x27;</span> <span class="keyword">in</span> placeholder_array:</span><br><span class="line">        answer[placeholder_array == <span class="string">&#x27;ğŸŸ©&#x27;</span>] = guess_array[placeholder_array == <span class="string">&#x27;ğŸŸ©&#x27;</span>]</span><br><span class="line">        <span class="comment"># print(&quot;&quot;.join(answer))</span></span><br><span class="line"></span><br><span class="line">    guess = re.findall(<span class="string">r&#x27;placeholder=&quot;(.*?)&quot;&#x27;</span>, html)[<span class="number">0</span>]</span><br><span class="line">    guess_array = np.array(<span class="built_in">list</span>(guess))</span><br><span class="line">    <span class="comment"># print(result)</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€è„šæœ¬éœ€è¦æå‰æŒ‡å®š3ä¸ªå˜é‡ï¼Œä»¥ä¸‹ä¸ºè¯´æ˜ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>å˜é‡å</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>n_loop</td>
<td>å¾ªç¯æ¬¡æ•°ï¼Œå»ºè®®500å³å¯</td>
</tr>
<tr>
<td>user_agent</td>
<td>è¾“å…¥è‡ªå·±æµè§ˆå™¨æ•°æ®è¯·æ±‚çš„User-Agent</td>
</tr>
<tr>
<td>cookie</td>
<td>è¯·æ±‚çš„cookie</td>
</tr>
<tr>
<td>guess</td>
<td>ä»»æ„è¾“å…¥å­—ç¬¦å³å¯ï¼ˆä¸ä¸€å®šä¸º64å­—ç¬¦ï¼Œä¹Ÿä¸ä¸€å®šä¸ºemojiï¼‰</td>
</tr>
</tbody>
</table>
</div>
<p>è§£é¢˜æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p>1ã€æ‰“å¼€æµè§ˆå™¨è®¿é—®é¢˜ç›®é¡µé¢ï¼Œå¹¶åˆ·æ–°ï¼Œé€šè¿‡â€œæ£€æŸ¥â€åŠŸèƒ½è·å–è·å–æºä»£ç çš„è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´é‡Œå¯ä»¥æ‰¾åˆ°User-Agentå’Œcookieã€‚å…¶ä¸­å¯¹äºcookieï¼ŒLevel 1ä¸é‡è¦ï¼ŒLevel 2çš„æ ¼å¼ä¼šç±»ä¼¼äº</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;PLAY_SESSION=eyJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImxldmVsIjoiMiIsInJlbWFpbmluZ19ndWVzc2VzIjoiOCIsInRhcmdldCI6Ilx...x...x...x...x...x...x...J9LCJuYmYiOjE2OTc0OTQ2OTIsImlhdCI6MTY5NzQ5NDY5Mn0.ISEVkOSj4SOcwubeiQsIgScgcwYpuPLo8oqRpD7M2cU; anticheat_canary=anylhetjnk&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­â€xâ€¦â€å­˜å‚¨äº†emojiçš„ä¿¡æ¯ï¼›Level 3çš„æ ¼å¼ç±»ä¼¼äº</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;PLAY_SESSION=eyJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7ImxldmVsIjoiMyIsInN0YXJ0X3RpbWUiOiIxNjk3NDk4NDY0MDc4IiwicmVtYWluaW5nX2d1ZXNzZXMiOiIzIiwic2VlZCI6IjMuMTY0NDQ1MDc4NTk0MDMxRTExIn0sIm5iZiI6MTY5NzQ5ODQ2NCwiaWF0IjoxNjk3NDk4NDY0fQ.88wkf3McLG5Wz3ybyMQzl-XKtmnZmXeLwHpolML2ZWk; anticheat_canary=anylhetjnk&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ç›¸æ¯”2ä¼šçŸ­ä¸€äº›ï¼Œéœ€è¦æ³¨æ„Level 3æœ‰1åˆ†é’Ÿçš„æœ‰æ•ˆæ—¶é—´ï¼Œéœ€è¦åœ¨ä¸€åˆ†é’Ÿå†…å°†ç¨‹åºçš„ç»“æœå¤åˆ¶åˆ°æµè§ˆå™¨ç»“æœå†…ã€‚</p>
<p>è¿™æ˜¯ä¸€ç§ä»çˆ¬è™«è§’åº¦è¿›è¡Œçš„æ–¹æ³•ã€‚é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œå°±æ²¡æœ‰äº†æ¯ä¸€æ¬¡çŒœæµ‹æ—¶çš„æ¬¡æ•°é™åˆ¶ã€‚</p>
<h1 id="æ±‰åŒ–ç»¿è‰²ç‰ˆå…è´¹ä¸‹è½½ï¼ˆé€šè¿‡ï¼‰"><a href="#æ±‰åŒ–ç»¿è‰²ç‰ˆå…è´¹ä¸‹è½½ï¼ˆé€šè¿‡ï¼‰" class="headerlink" title="æ±‰åŒ–ç»¿è‰²ç‰ˆå…è´¹ä¸‹è½½ï¼ˆé€šè¿‡ï¼‰"></a>æ±‰åŒ–ç»¿è‰²ç‰ˆå…è´¹ä¸‹è½½ï¼ˆé€šè¿‡ï¼‰</h1><p>(# prob25-krkr)</p>
<p>æœ¬é¢˜è§£æ³•å‚è€ƒäº†<a href="https://iyn.me/i/post-45.html">åšå®¢</a>ï¼Œä¸»è¦å·¥å…·ä¸ºkirikiriå¯¹.ksdå’Œ.kdtæ–‡ä»¶çš„è¯»å†™ã€‚</p>
<p>1ã€æ¸¸æˆæºç æ‰“å¼€åå¯ä»¥ç›´æ¥æŸ¥çœ‹flag1ã€‚</p>
<p>2ã€ä»datasu.ksdä¸­å¯ä»¥æ‰¾åˆ°â€œAEIOUâ€åˆ†åˆ«è¢«è¾“å…¥çš„æ¬¡æ•°å’Œæ€»å­—ç¬¦æ•°ã€‚æ¸¸æˆçš„é€»è¾‘å¦‚ä¸‹ï¼šé¦–å…ˆä¼šåˆå§‹åŒ–ä¸€ä¸ªhashå€¼ï¼Œåœ¨è¿™é‡Œæ˜¯1337ã€‚ç¬¬ä¸€éè¾“å…¥æ—¶ï¼Œä¼šæŒ‰ç…§è¾“å…¥â€œAEIOUâ€åˆ†åˆ«è¿›è¡Œä¸åŒçš„è¿ç®—æ“ä½œï¼Œç»“æŸæ—¶â€œ}â€ç¬¦å·ä¹Ÿä¼šå†å¯¹hashå€¼åšä¸€æ¬¡è¿ç®—ã€‚æœ€åï¼Œæ€»çš„å­—ç¬¦å’Œå“ˆå¸Œå€¼ä¼šåˆ†åˆ«ä¿å­˜åœ¨å­˜æ¡£ä¸­ã€‚ä»å­˜æ¡£æ–‡ä»¶å¯ä»¥å‘ç°ä¸€å…±18ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­6ä¸ªAï¼Œ3ä¸ªEï¼Œ1ä¸ªIï¼Œ6ä¸ªOï¼Œhashä»åˆå§‹çš„1337å˜ä¸º7748521.</p>
<p>ç¬¬ä¸€ä¸ªè„šæœ¬ç”¨äºåœ¨â€œinput.txtâ€æ–‡ä»¶ä¸­è¾“å…¥æ‰€æœ‰å¯èƒ½çš„ç»„åˆï¼ˆåœ¨äº’è”ç½‘ä¸Šè·å–çš„ï¼‰ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">char</span> *a, <span class="type">char</span> *b)</span> &#123;</span><br><span class="line">    <span class="type">char</span> temp = *a;</span><br><span class="line">    *a = *b;</span><br><span class="line">    *b = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">shouldSwap</span><span class="params">(<span class="type">char</span> *str, <span class="type">int</span> start, <span class="type">int</span> curr)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = start; i &lt; curr; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (str[i] == str[curr]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">permute</span><span class="params">(<span class="type">char</span> *str, <span class="type">int</span> index, <span class="type">int</span> length, FILE *fp)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (index == length - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(fp, <span class="string">&quot;%s\n&quot;</span>, str);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = index; i &lt; length; i++) &#123;</span><br><span class="line">        <span class="type">int</span> check = shouldSwap(str, index, i);</span><br><span class="line">        <span class="keyword">if</span> (check) &#123;</span><br><span class="line">            swap(&amp;str[index], &amp;str[i]);</span><br><span class="line">            permute(str, index + <span class="number">1</span>, length, fp);</span><br><span class="line">            swap(&amp;str[index], &amp;str[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> str[] = <span class="string">&quot;AAAAAAEEEIOOOOOO&quot;</span>;</span><br><span class="line">    <span class="type">int</span> length = <span class="built_in">strlen</span>(str);</span><br><span class="line">    FILE *fp;</span><br><span class="line">    fp = fopen(<span class="string">&quot;input.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">    permute(str, <span class="number">0</span>, length, fp);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒä¸ªæ–‡ä»¶åœ¨äºè¯»å…¥ç¬¬ä¸€ä¸ªæ–‡ä»¶è¾“å‡ºçš„æ’åˆ—ï¼Œé€ä¸€æµ‹è¯•æ˜¯å¦èƒ½é€šè¿‡hashå€¼çš„æ ¡éªŒã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="type">char</span> buffer[<span class="number">32</span>];</span><br><span class="line">  FILE *fp;</span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="type">long</span> <span class="type">int</span> hash;</span><br><span class="line"></span><br><span class="line">  fp = fopen(<span class="string">&quot;input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> (fgets(buffer, <span class="number">255</span>, fp)) &#123;</span><br><span class="line">    i++;</span><br><span class="line">    hash = <span class="number">1337</span>;</span><br><span class="line">    <span class="comment">// printf(&quot;%s&quot;, buffer);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(buffer); i++) &#123;</span><br><span class="line">        <span class="comment">// printf(&quot;%c&quot;, buffer[i]);</span></span><br><span class="line">        <span class="keyword">switch</span> (buffer[i]) &#123;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;A&#x27;</span>:</span><br><span class="line">            hash = hash * <span class="number">13337</span> + <span class="number">11</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">            hash = hash * <span class="number">13337</span> + <span class="number">22</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;I&#x27;</span>:</span><br><span class="line">            hash = hash * <span class="number">13337</span> + <span class="number">33</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;O&#x27;</span>:</span><br><span class="line">            hash = hash * <span class="number">13337</span> + <span class="number">44</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;U&#x27;</span>:</span><br><span class="line">            hash = hash * <span class="number">13337</span> + <span class="number">55</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        hash %= <span class="number">19260817</span>;</span><br><span class="line">        <span class="comment">// printf(&quot;%ld\n&quot;, hash);</span></span><br><span class="line">        assert (hash &gt;= <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    hash = hash * <span class="number">13337</span> + <span class="number">66</span>;</span><br><span class="line">    hash %= <span class="number">19260817</span>;</span><br><span class="line">    assert (hash &gt;= <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// printf(&quot;Hash = %ld\n&quot;, hash);</span></span><br><span class="line">    <span class="keyword">if</span> (hash == <span class="number">7748521</span>) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;result: %s\n&quot;</span>, buffer);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i % <span class="number">100000</span> == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d checked.\n&quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  fclose(fp);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œå°±å¯ä»¥è·å¾—å”¯ä¸€ç»“æœã€‚</p>
<h1 id="åˆå­¦Cè¯­è¨€ï¼ˆflag1ï¼‰"><a href="#åˆå­¦Cè¯­è¨€ï¼ˆflag1ï¼‰" class="headerlink" title="åˆå­¦Cè¯­è¨€ï¼ˆflag1ï¼‰"></a>åˆå­¦Cè¯­è¨€ï¼ˆflag1ï¼‰</h1><p>(# prob09-easyc)</p>
<p>æœ¬é¢˜åˆ©ç”¨äº†gccç¼–è¯‘printfæ ¼å¼åŒ–è¾“å‡ºæ—¶å¯ä»¥ä»»æ„è·å¾—æ ˆä¸Šå˜é‡çš„æ¼æ´ã€‚</p>
<p>ä¸‹è½½ç”¨é¢˜ç›®æºç å¸¦ä¸Š-gç¼–è¯‘ï¼Œå¹¶ç”¨gdbè°ƒè¯•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc pwn.c -o pwn -static-pie -g</span><br><span class="line">gdb a.out</span><br></pre></td></tr></table></figure>
<p>åœ¨gdbä¸­printfå¤„è®¾ç½®æ–­ç‚¹ï¼ŒéšåæŸ¥çœ‹æ ˆçš„æƒ…å†µ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">start</span><br><span class="line">b printf # ä¹‹åä»»æ„è¾“å…¥å€¼</span><br><span class="line">run</span><br><span class="line">stack 30</span><br></pre></td></tr></table></figure>
<p>çœ‹åˆ°æƒ³è¦è·å–çš„flag1ä½ç½®ä¸printfå‚æ•°çš„ä½ç½®(â€œa_public_stringâ€)æœ‰26çš„åç§»é‡ï¼Œå¯ä»¥åœ¨ç¨‹åºä¸­è¾“å…¥</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">%26$p %27$p %27$p %28$p</span><br></pre></td></tr></table></figure>
<p>è·å¾—</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">0x3465527b67616c66 0x66546e3172505f64 0x66546e3172505f64 0x6f735f654430635f</span><br></pre></td></tr></table></figure>
<p>å°†æ¯ä¸€ä¸ªå€¼åå‘æŒ‰16è¿›åˆ¶è½¬asciiç ï¼Œå°±å¾—åˆ°äº†flagã€‚</p>
<h1 id="å…³é”®è¯è¿‡æ»¤å–µï¼Œè°¢è°¢å–µï¼ˆflag1ï¼Œflag2ï¼‰"><a href="#å…³é”®è¯è¿‡æ»¤å–µï¼Œè°¢è°¢å–µï¼ˆflag1ï¼Œflag2ï¼‰" class="headerlink" title="å…³é”®è¯è¿‡æ»¤å–µï¼Œè°¢è°¢å–µï¼ˆflag1ï¼Œflag2ï¼‰"></a>å…³é”®è¯è¿‡æ»¤å–µï¼Œè°¢è°¢å–µï¼ˆflag1ï¼Œflag2ï¼‰</h1><p>1ã€flag1éœ€è¦ç»Ÿè®¡å­—ç¬¦æ•°é‡ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ€è·¯å³å¯å®Œæˆ</p>
<ul>
<li><p>æŠŠæ‰€æœ‰å­—ç¬¦æ›¿æ¢æˆç»Ÿä¸€å­—ç¬¦ï¼Œä¾‹å¦‚â€œAâ€</p>
</li>
<li><p>å¦‚æœæ²¡æœ‰â€œAâ€å°±æ›¿æ¢ä¸€ä¸ª0ï¼Œè¾“å‡ºå³å¯ç»“æŸ</p>
</li>
<li><p>æŠŠç¬¬ä¸€ä¸ªâ€œAâ€æ›¿æ¢æˆâ€œ0Aâ€ï¼Œâ€œ0â€ä»£è¡¨ç°åœ¨å¼€å§‹ç»Ÿè®¡äº†0ä¸ªå­—ç¬¦</p>
</li>
<li><p>æŠŠ0-8æ•°å­—+Açš„ç»„åˆæ›¿æ¢æˆå¤§1çš„æ•°å­—ï¼Œè¿™é‡Œéœ€è¦å†™å…«æ¡æŒ‡ä»¤ï¼Œæ„æ€æ˜¯æŠŠä¸ªä½æ•°åŠ 1ï¼Œå¹¶å»æ‰ä¸€ä¸ªå­—ç¬¦</p>
</li>
<li><p>å¦‚æœæ•°å­—æ˜¯9ï¼Œéœ€è¦è¿›ä½ï¼Œè¿›å…¥è¿›ä½æ¨¡å—</p>
</li>
<li><p>è¿›ä½éœ€è¦å¼•å…¥ä¸€ä¸ªè¿›ä½ç¬¦ï¼Œè¡¨ç¤ºè¿›1ä½ï¼Œä¾‹å¦‚Bï¼Œè¿›ä½æ—¶ï¼Œéœ€è¦ä¸æ–­æŠŠâ€œ9Aâ€æ›¿æ¢æˆâ€œ0Bâ€ï¼Œè¿™å¯ä»¥ç”¨äºé‡åˆ°å¤šæ¬¡è¿›ä½æ—¶ä¸æ–­è¿›ä½ã€‚</p>
</li>
<li><p>æœ€ç»ˆå¦‚æœæ²¡æœ‰â€œAâ€äº†ï¼Œå°±å¯ä»¥ç»“æŸ</p>
</li>
</ul>
<p>ä»¥ä¸‹æ˜¯å‚è€ƒçš„è§„åˆ™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æŠŠã€\s|\Sã€‘æ›¿æ¢æˆã€Aã€‘å–µ</span><br><span class="line">æŠŠã€^Aã€‘æ›¿æ¢æˆã€0Aã€‘å–µ</span><br><span class="line">æŠŠã€^$ã€‘æ›¿æ¢æˆã€0ã€‘å–µ</span><br><span class="line"></span><br><span class="line">åŠ ä¸€ï¼š</span><br><span class="line">  æŠŠã€0Aã€‘æ›¿æ¢æˆã€1ã€‘å–µ</span><br><span class="line">  æŠŠã€1Aã€‘æ›¿æ¢æˆã€2ã€‘å–µ</span><br><span class="line">  æŠŠã€2Aã€‘æ›¿æ¢æˆã€3ã€‘å–µ</span><br><span class="line">  æŠŠã€3Aã€‘æ›¿æ¢æˆã€4ã€‘å–µ</span><br><span class="line">  æŠŠã€4Aã€‘æ›¿æ¢æˆã€5ã€‘å–µ</span><br><span class="line">  æŠŠã€5Aã€‘æ›¿æ¢æˆã€6ã€‘å–µ</span><br><span class="line">  æŠŠã€6Aã€‘æ›¿æ¢æˆã€7ã€‘å–µ</span><br><span class="line">  æŠŠã€7Aã€‘æ›¿æ¢æˆã€8ã€‘å–µ</span><br><span class="line">  æŠŠã€8Aã€‘æ›¿æ¢æˆã€9ã€‘å–µ</span><br><span class="line">  å¦‚æœçœ‹åˆ°ã€9Aã€‘å°±è·³è½¬åˆ°ã€è¿›ä½ã€‘å–µ</span><br><span class="line">  å¦‚æœæ²¡çœ‹åˆ°ã€Aã€‘å°±è·³è½¬åˆ°ã€ç»“æŸã€‘å–µ</span><br><span class="line"></span><br><span class="line">è¿›ä½ï¼š</span><br><span class="line">  æŠŠã€9Aã€‘æ›¿æ¢æˆã€B0ã€‘å–µ</span><br><span class="line">  é‡å¤æŠŠã€9Bã€‘æ›¿æ¢æˆã€B0ã€‘å–µ</span><br><span class="line">  æŠŠã€8Bã€‘æ›¿æ¢æˆã€9ã€‘å–µ</span><br><span class="line">  æŠŠã€7Bã€‘æ›¿æ¢æˆã€8ã€‘å–µ</span><br><span class="line">  æŠŠã€6Bã€‘æ›¿æ¢æˆã€7ã€‘å–µ</span><br><span class="line">  æŠŠã€5Bã€‘æ›¿æ¢æˆã€6ã€‘å–µ</span><br><span class="line">  æŠŠã€4Bã€‘æ›¿æ¢æˆã€5ã€‘å–µ</span><br><span class="line">  æŠŠã€3Bã€‘æ›¿æ¢æˆã€4ã€‘å–µ</span><br><span class="line">  æŠŠã€2Bã€‘æ›¿æ¢æˆã€3ã€‘å–µ</span><br><span class="line">  æŠŠã€1Bã€‘æ›¿æ¢æˆã€2ã€‘å–µ</span><br><span class="line">  æŠŠã€0Bã€‘æ›¿æ¢æˆã€1ã€‘å–µ</span><br><span class="line">  æŠŠã€Bã€‘æ›¿æ¢æˆã€1ã€‘å–µ</span><br><span class="line">  å¦‚æœçœ‹åˆ°ã€Aã€‘å°±è·³è½¬åˆ°ã€åŠ ä¸€ã€‘å–µ</span><br><span class="line"></span><br><span class="line">ç»“æŸï¼š</span><br><span class="line">  è°¢è°¢å–µ</span><br></pre></td></tr></table></figure>
<p>2ã€å› ä¸ºåœ¨è¿™ä¸ªé—®é¢˜ä¸­åªæœ‰æ¢è¡Œç¬¦æ˜¯å¯ä»¥è‡ªç”±æ›¿æ¢ï¼Œä¸å½±å“ç»“æœçš„ï¼Œæ‰€ä»¥éœ€è¦çµæ´»è¿ç”¨æ¢è¡Œç¬¦çš„æ›¿æ¢ã€‚æ€è·¯å¦‚ä¸‹</p>
<ul>
<li><p>æŠŠæ‰€æœ‰æ¢è¡Œç¬¦å»é™¤ï¼Œå¹¶åœ¨å¼€å¤´ã€æœ«å°¾å’Œæ¯ä¸¤è¡Œä¹‹é—´æ’å…¥ä¸¤ä¸ªç©ºè¡Œ</p>
</li>
<li><p>å¼€å§‹æ—¶ï¼ŒæŠŠæ¯ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ååŠ å…¥æ¢è¡Œï¼Œè¿™æ ·æ‰€æœ‰æ–‡æœ¬ä¹‹é—´éƒ½ç©ºäº†ä¸¤è¡Œï¼Œæ¯ä¸€æ®µæ–‡æœ¬åˆ†å‰²æˆè¿ç»­çš„ä¸¤è¡Œï¼Œç¬¬ä¸€è¡Œè¡¨ç¤ºå·²ç»ç»Ÿè®¡çš„æ–‡æœ¬ï¼Œç¬¬äºŒè¡Œè¡¨ç¤ºå°šæœªç»Ÿè®¡çš„ï¼Œæ­¤åæ¯ä¸€æ¬¡éƒ½å°†ç¬¬äºŒè¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ”¾åˆ°ç¬¬ä¸€è¡Œæœ«å°¾</p>
</li>
<li><p>å¦‚æœé‡åˆ°å‡ºç°è¿ç»­3ä¸ªç©ºè¡Œï¼Œè¯´æ˜å·²ç»æœ‰ä¸€è¡Œæ–‡æœ¬ç»Ÿè®¡å®Œæ¯•ï¼Œè¿™æ˜¯æœ€çŸ­çš„é‚£ä¸€è¡Œæ–‡æœ¬ï¼Œå°†å…¶æ”¾åœ¨æœ€åä¸€è¡Œï¼ˆè¿™ä¸€æ­¥éœ€è¦å¤šæ¬¡åˆ¤æ–­ï¼Œä»¥é˜²æœ‰åŒæ ·é•¿åº¦çš„ï¼‰ï¼Œä¸è¿˜åœ¨ç»Ÿè®¡çš„æ–‡æœ¬ç”¨4ä¸ªæ¢è¡Œéš”å¼€ï¼Œä»¥é˜²ä¹‹å‰çš„æ“ä½œæ··ä¹±</p>
</li>
<li><p>ä¹‹åç»§ç»­é‡å¤ï¼Œæ¯é‡åˆ°ä¸€æ¬¡ä¸‰è¿æ¢è¡Œå°±å°†è¿™ä¸€æ¢è¡Œå‰çš„æ–‡æœ¬æ”¾ç½®æœ€å</p>
</li>
<li><p>æœ€åå¦‚æœæ²¡æœ‰è¿ç»­çš„ä¸¤è¡Œï¼Œè¯´æ˜ç»Ÿè®¡ç»“æŸï¼Œå°†æ‰€æœ‰æ¢è¡Œå»æ‰å³å¯</p>
</li>
</ul>
<p>æœ¬é¢˜åœ¨æµ‹è¯•æ—¶ï¼Œå‘ç°å¦‚æœæœ€çŸ­è¡Œå”¯ä¸€ä¸”åœ¨æœ€åä¸€è¡Œçš„æ—¶å€™ä¼šåœ¨å°†è¿™ä¸€è¡Œç§»åˆ°æœ«å°¾æ—¶æ¢è¡Œæ•°é‡å‡ºç°é—®é¢˜ï¼Œå› æ­¤æˆ‘å°†ç­”æ¡ˆæ“ä½œçš„ä¸»ä½“å†…å®¹äº†ä¸¤éã€‚å®é™…ä¸Šï¼Œå¦‚æœé‡åˆ°åªæœ‰é•¿åº¦ä¸åŒçš„ä¸¤è¡Œçš„æƒ…å†µï¼Œä¸”çŸ­è¡Œåœ¨ç¬¬äºŒè¡Œæ—¶ï¼Œè¾“å‡ºæ˜¯ä¸å¯¹çš„ã€‚ä½†æ˜¯æµ‹è¯•ç”¨ä¾‹é‡Œä¼¼ä¹æ²¡æœ‰è¿™æ ·çš„ä¾‹å­ï¼Œæˆ‘ç¼–è¯‘é€šè¿‡ä¹‹åå°±æ²¡æœ‰ç»§ç»­æ”¹äº†ã€‚å‚è€ƒæºç å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¦‚æœæ²¡çœ‹åˆ°ã€\nã€‘å°±è·³è½¬åˆ°ã€ç»“æŸã€‘å–µ</span><br><span class="line">é‡å¤æŠŠã€\n&#123;2&#125;ã€‘æ›¿æ¢æˆã€\nã€‘å–µ</span><br><span class="line">é‡å¤æŠŠã€^\nã€‘æ›¿æ¢æˆã€ã€‘å–µ</span><br><span class="line">é‡å¤æŠŠã€\n$ã€‘æ›¿æ¢æˆã€ã€‘å–µ</span><br><span class="line">æŠŠã€\nã€‘æ›¿æ¢æˆã€\n\nã€‘å–µ</span><br><span class="line">æŠŠã€^ã€‘æ›¿æ¢æˆã€\n\nã€‘å–µ</span><br><span class="line">æŠŠã€$ã€‘æ›¿æ¢æˆã€\n\nã€‘å–µ</span><br><span class="line"></span><br><span class="line">æŠŠã€\n&#123;2&#125;(.)ã€‘æ›¿æ¢æˆã€\n\n\1\nã€‘å–µ</span><br><span class="line">å¦‚æœçœ‹åˆ°ã€.+\n&#123;3&#125;[^\n]ã€‘å°±è·³è½¬åˆ°ã€æœ‰è¡Œç»“æŸ1ã€‘å–µ</span><br><span class="line">å¦‚æœæ²¡çœ‹åˆ°ã€\n&#123;2&#125;(.+)\n&#123;1&#125;(.)ã€‘å°±è·³è½¬åˆ°ã€ç»“æŸ1ã€‘å–µ</span><br><span class="line"></span><br><span class="line">å³ç§»1ï¼š</span><br><span class="line">  æŠŠã€\n&#123;2&#125;(.+)\n&#123;1&#125;(.)ã€‘æ›¿æ¢æˆã€\n\n\1\2\nã€‘å–µ</span><br><span class="line">  å¦‚æœæ²¡çœ‹åˆ°ã€.+\n&#123;3&#125;[^\n]ã€‘å°±è·³è½¬åˆ°ã€å³ç§»1ã€‘å–µ</span><br><span class="line"></span><br><span class="line">æœ‰è¡Œç»“æŸ1ï¼š</span><br><span class="line">  æŠŠã€(.+\n&#123;3&#125;)&#123;1&#125;((\w|\W)*)$ã€‘æ›¿æ¢æˆã€\2\1\nã€‘å–µ</span><br><span class="line">  å¦‚æœçœ‹åˆ°ã€.+\n&#123;3&#125;[^\n]ã€‘å°±è·³è½¬åˆ°ã€æœ‰è¡Œç»“æŸ1ã€‘å–µ</span><br><span class="line">  å¦‚æœçœ‹åˆ°ã€\n&#123;2&#125;(.+)\n&#123;1&#125;(.)ã€‘å°±è·³è½¬åˆ°ã€å³ç§»1ã€‘å–µ</span><br><span class="line"></span><br><span class="line">ç»“æŸ1ï¼š</span><br><span class="line">  é‡å¤æŠŠã€\n\nã€‘æ›¿æ¢æˆã€\nã€‘å–µ</span><br><span class="line">  æŠŠã€^\nã€‘æ›¿æ¢æˆã€ã€‘å–µ</span><br><span class="line">  æŠŠã€\n$ã€‘æ›¿æ¢æˆã€ã€‘å–µ</span><br><span class="line"></span><br><span class="line">å¦‚æœæ²¡çœ‹åˆ°ã€\nã€‘å°±è·³è½¬åˆ°ã€ç»“æŸã€‘å–µ</span><br><span class="line">é‡å¤æŠŠã€\n&#123;2&#125;ã€‘æ›¿æ¢æˆã€\nã€‘å–µ</span><br><span class="line">é‡å¤æŠŠã€^\nã€‘æ›¿æ¢æˆã€ã€‘å–µ</span><br><span class="line">é‡å¤æŠŠã€\n$ã€‘æ›¿æ¢æˆã€ã€‘å–µ</span><br><span class="line">æŠŠã€\nã€‘æ›¿æ¢æˆã€\n\nã€‘å–µ</span><br><span class="line">æŠŠã€^ã€‘æ›¿æ¢æˆã€\n\nã€‘å–µ</span><br><span class="line">æŠŠã€$ã€‘æ›¿æ¢æˆã€\n\nã€‘å–µ</span><br><span class="line"></span><br><span class="line">æŠŠã€\n&#123;2&#125;(.)ã€‘æ›¿æ¢æˆã€\n\n\1\nã€‘å–µ</span><br><span class="line">å¦‚æœçœ‹åˆ°ã€.+\n&#123;3&#125;[^\n]ã€‘å°±è·³è½¬åˆ°ã€æœ‰è¡Œç»“æŸ2ã€‘å–µ</span><br><span class="line">å¦‚æœæ²¡çœ‹åˆ°ã€\n&#123;2&#125;(.+)\n&#123;1&#125;(.)ã€‘å°±è·³è½¬åˆ°ã€ç»“æŸã€‘å–µ</span><br><span class="line"></span><br><span class="line">å³ç§»2ï¼š</span><br><span class="line">  æŠŠã€\n&#123;2&#125;(.+)\n&#123;1&#125;(.)ã€‘æ›¿æ¢æˆã€\n\n\1\2\nã€‘å–µ</span><br><span class="line">  å¦‚æœæ²¡çœ‹åˆ°ã€.+\n&#123;3&#125;[^\n]ã€‘å°±è·³è½¬åˆ°ã€å³ç§»2ã€‘å–µ</span><br><span class="line"></span><br><span class="line">æœ‰è¡Œç»“æŸ2ï¼š</span><br><span class="line">  æŠŠã€(.+\n&#123;3&#125;)&#123;1&#125;((\w|\W)*)$ã€‘æ›¿æ¢æˆã€\2\1\nã€‘å–µ</span><br><span class="line">  å¦‚æœçœ‹åˆ°ã€.+\n&#123;3&#125;[^\n]ã€‘å°±è·³è½¬åˆ°ã€æœ‰è¡Œç»“æŸ2ã€‘å–µ</span><br><span class="line">  å¦‚æœçœ‹åˆ°ã€\n&#123;2&#125;(.+)\n&#123;1&#125;(.)ã€‘å°±è·³è½¬åˆ°ã€å³ç§»2ã€‘å–µ</span><br><span class="line"></span><br><span class="line">ç»“æŸï¼š</span><br><span class="line">  é‡å¤æŠŠã€\n\nã€‘æ›¿æ¢æˆã€\nã€‘å–µ</span><br><span class="line">  æŠŠã€^\nã€‘æ›¿æ¢æˆã€ã€‘å–µ</span><br><span class="line">  æŠŠã€\n$ã€‘æ›¿æ¢æˆã€ã€‘å–µ</span><br><span class="line"></span><br><span class="line">æ„Ÿè°¢ï¼š</span><br><span class="line">  è°¢è°¢å–µ</span><br></pre></td></tr></table></figure>
<h1 id="å°ç« é±¼çš„æ›²å¥‡ï¼ˆé€šè¿‡ï¼‰"><a href="#å°ç« é±¼çš„æ›²å¥‡ï¼ˆé€šè¿‡ï¼‰" class="headerlink" title="å°ç« é±¼çš„æ›²å¥‡ï¼ˆé€šè¿‡ï¼‰"></a>å°ç« é±¼çš„æ›²å¥‡ï¼ˆé€šè¿‡ï¼‰</h1><p>(#prob08-cookie)</p>
<p>æœ¬é¢˜åŸç†æ˜¯åŸºäºpythonéšæœºæ•°çš„ç®—æ³•æ˜¯MT19937ï¼Œè¿™ä¸€ç®—æ³•æ ¹æ®å‰624ä¸ª8å­—èŠ‚çš„æ•°å¯ä»¥ç¡®å®šçŠ¶æ€ï¼Œä»è€Œé¢„æµ‹åç»­çš„éšæœºæ•°ã€‚æœ¬é¢˜ç›´æ¥é‡‡ç”¨ä»¥å¼€å‘å¥½çš„pythonç¬¬ä¸‰æ–¹åº“randcrackã€‚</p>
<p>1ã€åˆšå¼€å§‹æé”™äº†ä½æ•°ï¼Œä»£ç ç»è¿‡äº†ä¸€äº›æ— è„‘ä¿®æ”¹ï¼Œå†™çš„è´¨é‡ä¸é«˜ã€‚æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>wordsçš„å‰2500ä¸ªå­—ç¬¦æ˜¯0ï¼Œå› æ­¤ä¸éšæœºæ•°å¼‚æˆ–è¿ç®—åä¿ç•™çš„æ˜¯éšæœºæ•°æœ¬èº«ï¼Œé€šè¿‡è¿™äº›å­—èŠ‚é¢„æµ‹åç»­éšæœºæ•°ï¼Œåœ¨å¼‚æˆ–å›å»å°±å¯ä»¥å¾—åˆ°words</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">result = <span class="string">&quot;???&quot;</span> <span class="comment"># è¾“å…¥è¾“å‡ºç»“æœ</span></span><br><span class="line">result_bytes = <span class="built_in">bytes</span>.fromhex(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decom_32_to_8</span>(<span class="params">num</span>):</span><br><span class="line">    num_decom = []</span><br><span class="line">    num_decom.append(num // (<span class="number">1</span> &lt;&lt; <span class="number">24</span>))</span><br><span class="line">    num %= (<span class="number">1</span> &lt;&lt; <span class="number">24</span>)</span><br><span class="line">    num_decom.append(num // (<span class="number">1</span> &lt;&lt; <span class="number">16</span>))</span><br><span class="line">    num %= (<span class="number">1</span> &lt;&lt; <span class="number">16</span>)</span><br><span class="line">    num_decom.append(num // (<span class="number">1</span> &lt;&lt; <span class="number">8</span>))</span><br><span class="line">    num %= (<span class="number">1</span> &lt;&lt; <span class="number">8</span>)</span><br><span class="line">    num_decom.append(num)</span><br><span class="line">    <span class="keyword">return</span> num_decom</span><br><span class="line"></span><br><span class="line">rc = RandCrack()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    num_submit = (result_bytes[<span class="number">4</span> * i] &lt;&lt; <span class="number">0</span>) + (result_bytes[<span class="number">4</span> * i + <span class="number">1</span>] &lt;&lt; <span class="number">8</span>) + (result_bytes[<span class="number">4</span> * i + <span class="number">2</span>] &lt;&lt; <span class="number">16</span>) + (result_bytes[<span class="number">4</span> * i + <span class="number">3</span>] &lt;&lt; <span class="number">24</span>)</span><br><span class="line">    rc.submit(num_submit)</span><br><span class="line">num32_pre_1 = rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line">num32_pre_2 = rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line">num32_pre_3 = rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line">num32_pre_4 = rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line">num32_pre_5 = rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line">num32_pre_6 = rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line">num32_pre_7 = rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line">num32_pre_8 = rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">next</span> = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>)]</span><br><span class="line"></span><br><span class="line"><span class="built_in">next</span>[<span class="number">3</span>], <span class="built_in">next</span>[<span class="number">2</span>], <span class="built_in">next</span>[<span class="number">1</span>], <span class="built_in">next</span>[<span class="number">0</span>] = decom_32_to_8(num32_pre_1)</span><br><span class="line"><span class="built_in">next</span>[<span class="number">7</span>], <span class="built_in">next</span>[<span class="number">6</span>], <span class="built_in">next</span>[<span class="number">5</span>], <span class="built_in">next</span>[<span class="number">4</span>] = decom_32_to_8(num32_pre_2)</span><br><span class="line"><span class="built_in">next</span>[<span class="number">11</span>], <span class="built_in">next</span>[<span class="number">10</span>], <span class="built_in">next</span>[<span class="number">9</span>], <span class="built_in">next</span>[<span class="number">8</span>]= decom_32_to_8(num32_pre_3)</span><br><span class="line"><span class="built_in">next</span>[<span class="number">15</span>], <span class="built_in">next</span>[<span class="number">14</span>], <span class="built_in">next</span>[<span class="number">13</span>], <span class="built_in">next</span>[<span class="number">12</span>] = decom_32_to_8(num32_pre_4)</span><br><span class="line"><span class="built_in">next</span>[<span class="number">19</span>], <span class="built_in">next</span>[<span class="number">18</span>], <span class="built_in">next</span>[<span class="number">17</span>], <span class="built_in">next</span>[<span class="number">16</span>] = decom_32_to_8(num32_pre_5)</span><br><span class="line"><span class="built_in">next</span>[<span class="number">23</span>], <span class="built_in">next</span>[<span class="number">22</span>], <span class="built_in">next</span>[<span class="number">21</span>], <span class="built_in">next</span>[<span class="number">20</span>] = decom_32_to_8(num32_pre_6)</span><br><span class="line"><span class="built_in">next</span>[<span class="number">27</span>], <span class="built_in">next</span>[<span class="number">26</span>], <span class="built_in">next</span>[<span class="number">25</span>], <span class="built_in">next</span>[<span class="number">24</span>] = decom_32_to_8(num32_pre_7)</span><br><span class="line"><span class="built_in">next</span>[<span class="number">31</span>], <span class="built_in">next</span>[<span class="number">30</span>], <span class="built_in">next</span>[<span class="number">29</span>], <span class="built_in">next</span>[<span class="number">28</span>] = decom_32_to_8(num32_pre_8)</span><br><span class="line"><span class="built_in">next</span>[<span class="number">35</span>], <span class="built_in">next</span>[<span class="number">34</span>], <span class="built_in">next</span>[<span class="number">33</span>], <span class="built_in">next</span>[<span class="number">32</span>] = decom_32_to_8(num32_pre_8)</span><br><span class="line"></span><br><span class="line">next_hex = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>):</span><br><span class="line">    next_hex[i] = <span class="string">f&#x27;<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">next</span>[i])[<span class="number">2</span>:]:<span class="number">0</span>&gt;<span class="number">2</span>&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">last_34 = <span class="string">&#x27;&#x27;</span>.join(next_hex[:<span class="number">34</span>])</span><br><span class="line">flag_bytes = [(x ^ y) <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(<span class="built_in">bytes</span>.fromhex(last_34), result_bytes[-<span class="number">33</span>:])]</span><br><span class="line"><span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> flag_bytes])</span><br><span class="line"><span class="comment"># flag_bytes</span></span><br></pre></td></tr></table></figure>
<p>2ã€ç¬¬äºŒé¢˜ç±»ä¼¼ï¼Œä¸»è¦åˆ©ç”¨çš„æ˜¯å¼‚æˆ–çš„äº¤æ¢å¾‹ã€ç»“åˆå¾‹ã€é€†è¿ç®—ä¸ºæœ¬èº«ã€‚åœ¨è¿™é‡Œè™½ç„¶è®¾ç½®äº†ç†µå¯¹éšæœºæ•°è¿›è¡Œäº†åç§»ï¼Œä½†æ˜¯æµ‹è¯•å¯ä»¥å‘ç°éšæœºæ•°å¼‚æˆ–åä¸ä¼šå½±å“ç»“æœã€‚</p>
<ul>
<li>ç”¨éšæœºæ•°ç§å­äº§ç”Ÿä¸¤ä¸ªéšæœºæ•°çŠ¶æ€ï¼Œç†µä»0å¼€å§‹è®¡ç®—ï¼Œæ¯ä¸€æ¬¡æŒ‰ç…§wordså’Œè¾“å‡ºç»“æœçš„å…³ç³»è¿›è¡Œå¼‚æˆ–è¿ç®—ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">result = <span class="string">&quot;???&quot;</span> <span class="comment"># è¾“å…¥è¾“å‡ºç»“æœ</span></span><br><span class="line">result_bytes = <span class="built_in">bytes</span>.fromhex(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decom_32_to_8</span>(<span class="params">num</span>):</span><br><span class="line">    num_decom = []</span><br><span class="line">    num_decom.append(num // (<span class="number">1</span> &lt;&lt; <span class="number">24</span>))</span><br><span class="line">    num %= (<span class="number">1</span> &lt;&lt; <span class="number">24</span>)</span><br><span class="line">    num_decom.append(num // (<span class="number">1</span> &lt;&lt; <span class="number">16</span>))</span><br><span class="line">    num %= (<span class="number">1</span> &lt;&lt; <span class="number">16</span>)</span><br><span class="line">    num_decom.append(num // (<span class="number">1</span> &lt;&lt; <span class="number">8</span>))</span><br><span class="line">    num %= (<span class="number">1</span> &lt;&lt; <span class="number">8</span>)</span><br><span class="line">    num_decom.append(num)</span><br><span class="line">    <span class="keyword">return</span> num_decom</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> entropy <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> &lt;&lt; <span class="number">22</span>):</span><br><span class="line">    void1 = Random(seed1)</span><br><span class="line">    void2 = Random(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    void1.randbytes(entropy)</span><br><span class="line">    void2.randbytes(entropy)</span><br><span class="line"></span><br><span class="line">    vd1 = void1.randbytes(<span class="number">2533</span>)</span><br><span class="line">    vd2 = void2.randbytes(<span class="number">2533</span>)</span><br><span class="line"></span><br><span class="line">    first_result = xor_arrays(result_bytes, vd1, vd2)</span><br><span class="line">    rc = RandCrack()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        num_submit = (first_result[<span class="number">4</span> * i] &lt;&lt; <span class="number">0</span>) + (first_result[<span class="number">4</span> * i + <span class="number">1</span>] &lt;&lt; <span class="number">8</span>) + (first_result[<span class="number">4</span> * i + <span class="number">2</span>] &lt;&lt; <span class="number">16</span>) + (first_result[<span class="number">4</span> * i + <span class="number">3</span>] &lt;&lt; <span class="number">24</span>)</span><br><span class="line">        rc.submit(num_submit)</span><br><span class="line"></span><br><span class="line">    random_2496_2535 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        r1, r2, r3, r4 = decom_32_to_8(rc.predict_getrandbits(<span class="number">32</span>))</span><br><span class="line">        random_2496_2535.append(r4)</span><br><span class="line">        random_2496_2535.append(r3)</span><br><span class="line">        random_2496_2535.append(r2)</span><br><span class="line">        random_2496_2535.append(r1)</span><br><span class="line"></span><br><span class="line">    random_2500_2532 = random_2496_2535[<span class="number">4</span>:-<span class="number">3</span>]</span><br><span class="line">    vd3_pre = <span class="string">b&#x27;&#x27;</span>.join([<span class="built_in">bytes</span>.fromhex(<span class="string">f&#x27;<span class="subst">&#123;<span class="built_in">hex</span>(i)[<span class="number">2</span>:]:<span class="number">0</span>&gt;<span class="number">2</span>&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> random_2500_2532])</span><br><span class="line"></span><br><span class="line">    vd123 = xor_arrays(vd1[<span class="number">2500</span>:], vd2[<span class="number">2500</span>:], vd3_pre)</span><br><span class="line"></span><br><span class="line">    flag_bytes = [(x ^ y) <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(vd123, result_bytes[<span class="number">2500</span>:])]</span><br><span class="line">    answer = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> flag_bytes])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> answer:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;\n<span class="subst">&#123;answer&#125;</span>\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;\r<span class="subst">&#123;entropy&#125;</span> / <span class="subst">&#123;<span class="number">1</span> &lt;&lt; <span class="number">22</span>&#125;</span> has finished.&#x27;</span> , end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>3ã€åˆ©ç”¨zipå‚æ•°é•¿åº¦ä¸ä¸€è‡´æ—¶åªä¼šå–æœ€çŸ­çš„é‚£ä¸ªï¼Œå¤åˆ¶è¾“å…¥ç¬¬ä¸€ä¸ªåå…­è¿›åˆ¶çš„éšæœºæ•°å°±èƒ½é€šè¿‡ã€‚</p>
<h1 id="åç»´ç ï¼ˆflag1ï¼‰"><a href="#åç»´ç ï¼ˆflag1ï¼‰" class="headerlink" title="åç»´ç ï¼ˆflag1ï¼‰"></a>åç»´ç ï¼ˆflag1ï¼‰</h1><p>(# prob19-qrcode)</p>
<p>æœ¬é¢˜æ— éœ€åœ¨ç½‘é¡µä¸Šé€šè¿‡åå®¹é“ï¼Œç›´æ¥æ‹¼å‡ºäºŒç»´ç æ‰«æå³å¯ã€‚æœ¬é¢˜ä½¿ç”¨pythonç¬¬ä¸‰æ–¹åº“pyzbarè¿›è¡ŒäºŒç»´ç æ‰«æï¼Œæ€è·¯åˆ†ä¸¤æ­¥ã€‚</p>
<ul>
<li><p>é€šè¿‡æµè§ˆå™¨æŠ“åŒ…åŠŸèƒ½ä¸‹è½½24å¼ å›¾ç‰‡ï¼Œå¯ä»¥å‘ç°ç¼ºå°‘çš„æ˜¯äºŒç»´ç å·¦ä¸Šçš„å›¾ï¼Œç›´æ¥æ—‹è½¬ä¸€å¼ å³ä¸Šæˆ–å·¦ä¸‹çš„å›¾å³å¯</p>
</li>
<li><p>flag1æ˜¯version 2çš„äºŒç»´ç ã€‚æŒ‰ç…§äºŒç»´ç çš„è§„èŒƒï¼Œå¯ä»¥ç¡®å®š16å¼ å›¾ç‰‡çš„ä½ç½®ã€‚å‰©ä¸‹çš„9å¼ å›¾ç‰‡ï¼Œç¬¬4è¡Œç¬¬5ä¸ªå›¾ç‰‡åªæœ‰ä¸¤ç§å¯èƒ½æ€§ã€‚å³ä¸‹è§’çš„é‚£ä¸€å¼ å¿…é¡»å·¦ä¸Šæ–¹æ˜¯é»‘ç‚¹ã€‚æ’åˆ—ç»„åˆåä¸€å…±æœ‰65520ç§æƒ…å†µã€‚</p>
</li>
<li><p>ä½¿ç”¨pythonçš„pillowè¿›è¡Œå›¾ç‰‡æ‹¼æ¥ï¼Œå¹¶é€ä¸€æ‰«æå³å¯è·å¾—ç­”æ¡ˆã€‚</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">pixel = <span class="number">50</span></span><br><span class="line"></span><br><span class="line">pic_dir = <span class="string">&#x27;./picture/&#x27;</span></span><br><span class="line">save_dir = <span class="string">&#x27;./qrcode/&#x27;</span></span><br><span class="line"><span class="comment"># pic_file_list = [file for file in os.listdir(pic_dir) if &quot;.png&quot; in file]</span></span><br><span class="line"></span><br><span class="line">fix_file_list = [<span class="string">&#x27;AA.png&#x27;</span>, <span class="string">&#x27;AB.png&#x27;</span>, <span class="string">&#x27;AD.png&#x27;</span>, <span class="string">&#x27;AE.png&#x27;</span>, <span class="string">&#x27;BA.png&#x27;</span>, <span class="string">&#x27;BB.png&#x27;</span>, <span class="string">&#x27;BC.png&#x27;</span>, <span class="string">&#x27;BD.png&#x27;</span>, <span class="string">&#x27;BE.png&#x27;</span>, <span class="string">&#x27;CB.png&#x27;</span>, <span class="string">&#x27;DA.png&#x27;</span>, <span class="string">&#x27;DB.png&#x27;</span>, <span class="string">&#x27;DD.png&#x27;</span>, <span class="string">&#x27;EA.png&#x27;</span>, <span class="string">&#x27;EB.png&#x27;</span>, <span class="string">&#x27;ED.png&#x27;</span>]</span><br><span class="line">fix_locs = [[<span class="number">0</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">0</span>], [<span class="number">3</span>, <span class="number">0</span>], [<span class="number">4</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">1</span>], [<span class="number">3</span>, <span class="number">1</span>], [<span class="number">4</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">2</span>], [<span class="number">0</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">3</span>], [<span class="number">3</span>, <span class="number">3</span>], [<span class="number">0</span>, <span class="number">4</span>], [<span class="number">1</span>, <span class="number">4</span>], [<span class="number">3</span>, <span class="number">4</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># DEpos_file_list = [&#x27;DE1.png&#x27;, &#x27;DE2.png&#x27;]</span></span><br><span class="line"><span class="comment"># other_file_list = [&#x27;e1.png&#x27;, &#x27;e2.png&#x27;, &#x27;e3.png&#x27;, &#x27;e4.png&#x27;, &#x27;e5.png&#x27;, &#x27;e6.png&#x27;, &#x27;n1.png&#x27;]</span></span><br><span class="line">mob_file_list = [<span class="string">&#x27;DE1.png&#x27;</span>, <span class="string">&#x27;DE2.png&#x27;</span>, <span class="string">&#x27;e1.png&#x27;</span>, <span class="string">&#x27;e2.png&#x27;</span>, <span class="string">&#x27;e3.png&#x27;</span>, <span class="string">&#x27;e4.png&#x27;</span>, <span class="string">&#x27;e5.png&#x27;</span>, <span class="string">&#x27;e6.png&#x27;</span>, <span class="string">&#x27;n1.png&#x27;</span>]</span><br><span class="line">mob_locs = [[<span class="number">2</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">2</span>], [<span class="number">2</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">2</span>], [<span class="number">4</span>, <span class="number">2</span>], [<span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">3</span>] ,[<span class="number">2</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">4</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># image_aa = Image.open(f&#x27;&#123;pic_dir&#125;AA.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_ab = Image.open(f&#x27;&#123;pic_dir&#125;AB.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_ad = Image.open(f&#x27;&#123;pic_dir&#125;AD.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_ae = Image.open(f&#x27;&#123;pic_dir&#125;AE.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_ba = Image.open(f&#x27;&#123;pic_dir&#125;BA.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_bb = Image.open(f&#x27;&#123;pic_dir&#125;BB.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_bc = Image.open(f&#x27;&#123;pic_dir&#125;BC.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_bd = Image.open(f&#x27;&#123;pic_dir&#125;BD.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_be = Image.open(f&#x27;&#123;pic_dir&#125;BE.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_cb = Image.open(f&#x27;&#123;pic_dir&#125;CB.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_da = Image.open(f&#x27;&#123;pic_dir&#125;DA.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_db = Image.open(f&#x27;&#123;pic_dir&#125;DB.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_dd = Image.open(f&#x27;&#123;pic_dir&#125;DD.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_ea = Image.open(f&#x27;&#123;pic_dir&#125;EA.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_eb = Image.open(f&#x27;&#123;pic_dir&#125;EB.png&#x27;)</span></span><br><span class="line"><span class="comment"># image_ed = Image.open(f&#x27;&#123;pic_dir&#125;ED.png&#x27;)</span></span><br><span class="line"></span><br><span class="line">fix_images = []</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> fix_file_list:</span><br><span class="line">    image = Image.<span class="built_in">open</span>(<span class="string">f&#x27;<span class="subst">&#123;pic_dir&#125;</span><span class="subst">&#123;file&#125;</span>&#x27;</span>)</span><br><span class="line">    fix_images.append(image)</span><br><span class="line"></span><br><span class="line">mob_images = []</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> mob_file_list:</span><br><span class="line">    image = Image.<span class="built_in">open</span>(<span class="string">f&#x27;<span class="subst">&#123;pic_dir&#125;</span><span class="subst">&#123;file&#125;</span>&#x27;</span>)</span><br><span class="line">    mob_images.append(image)</span><br><span class="line"></span><br><span class="line">big_image = Image.new(<span class="string">&quot;1&quot;</span>, (<span class="number">250</span>, <span class="number">250</span>))</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(loc_arange)):</span><br><span class="line">    mob_locs_j = loc_arange[j]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(fix_images)):</span><br><span class="line">        big_image.paste(fix_images[i], <span class="built_in">list</span>(pixel * np.array(fix_locs[i])))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mob_images)):</span><br><span class="line">        big_image.paste(mob_images[i], <span class="built_in">list</span>(pixel * np.array(mob_locs_j[i])))</span><br><span class="line">    big_image.save(<span class="string">f&#x27;<span class="subst">&#123;save_dir&#125;</span>big_image_<span class="subst">&#123;j&#125;</span>.png&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;\rImage <span class="subst">&#123;j + <span class="number">1</span>&#125;</span> / <span class="subst">&#123;<span class="built_in">len</span>(loc_arange)&#125;</span> saved.&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">qr_dir = <span class="string">&#x27;./qrcode/&#x27;</span></span><br><span class="line">images = [f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(qr_dir) <span class="keyword">if</span> <span class="keyword">not</span> f.startswith(<span class="string">&#x27;.&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(images)):</span><br><span class="line">    image = Image.<span class="built_in">open</span>(<span class="string">f&#x27;<span class="subst">&#123;qr_dir&#125;</span>big_image_<span class="subst">&#123;i&#125;</span>.png&#x27;</span>) <span class="comment"># Open the image file</span></span><br><span class="line">    data = decode(image) <span class="comment"># Decode the QR code in the image</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Check if the QR code is valid</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(data) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;\nbig_image_<span class="subst">&#123;i&#125;</span> is valid.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;\r<span class="subst">&#123;i + <span class="number">1</span>&#125;</span> / <span class="subst">&#123;<span class="built_in">len</span>(images)&#125;</span> has finished&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>competition</category>
      </categories>
      <tags>
        <tag>geekgame</tag>
        <tag>CTF</tag>
        <tag>å‚èµ›è®°å½•</tag>
      </tags>
  </entry>
  <entry>
    <title>MacOSç³»ç»Ÿä¸‹x86_64-linuxäº¤å‰ç¼–è¯‘è®°å½•</title>
    <url>/2023/11/15/cross-compilation-on-MacOS/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨è‡ªå­¦<a href="https://jyywiki.cn/OS/2023/index.html">NJU OS: Operating System Design and Implementation</a>è¯¾ç¨‹çš„è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„å®éªŒéƒ½åœ¨Abstract Machineä¸Šå®Œæˆï¼Œæºç å¯ä»¥å‚è€ƒ<a href="https://git.nju.edu.cn/jyy/os-workbench">Yanyan Jiang / os-workbench Â· æç‹GitLab</a>ã€‚Abstract Machineå¯ä»¥æ”¯æŒå¤šç§æ¶æ„ï¼Œä½†éƒ½éœ€è¦åœ¨Linuxå†…æ ¸ä¸­å®Œæˆã€‚æœ¬äººå¹³æ—¶ç”¨çš„æ˜¯macOSç³»ç»Ÿï¼Œå› æ­¤ä¸èƒ½è¿è¡ŒLinuxä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œéœ€è¦é€šè¿‡Linuxè™šæ‹Ÿæœºå®Œæˆå®éªŒã€‚ä½†å¦ä¸€æ–¹é¢ï¼Œå®éªŒæœ€ç»ˆæ˜¯é€šè¿‡<code>qemu</code>è¿è¡Œè™šæ‹Ÿæœºçš„æ–¹å¼è½½å…¥Abstract Machineï¼Œæ‰€ä»¥ç†è®ºä¸Šå¯ä»¥ä¸éœ€è¦åœ¨macOSä¸Šè¿è¡Œç¨‹åºã€‚äºæ˜¯æŸä¸€å¤©æœ¬äººçªå‘å¥‡æƒ³ï¼Œèƒ½ä¸èƒ½é€šè¿‡äº¤å‰ç¼–è¯‘çš„æ–¹å¼ï¼Œåœ¨macOSä¸Šç¼–è¯‘å‡ºLinuxçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶ç”¨<code>qemu</code>è¿è¡Œï¼Œè¿™æ ·å°±å¯ä»¥é¿å¼€è™šæ‹Ÿæœºçš„ä½¿ç”¨ã€‚æœ¬æ–‡å°±ç®€å•æ¢³ç†äº†å°†è¿™ä¸€æƒ³æ³•å®ç°çš„è¿‡ç¨‹ã€‚</p>
<h1 id="å…³äºäº¤å‰ç¼–è¯‘"><a href="#å…³äºäº¤å‰ç¼–è¯‘" class="headerlink" title="å…³äºäº¤å‰ç¼–è¯‘"></a>å…³äºäº¤å‰ç¼–è¯‘</h1><p>äº¤å‰ç¼–è¯‘æ˜¯ä¸€ç§ç¼–è¯‘æŠ€æœ¯ï¼Œå®ƒå…è®¸å¼€å‘è€…åœ¨ä¸€ä¸ªå¹³å°ï¼ˆç§°ä¸ºä¸»æœºï¼‰ä¸Šç”Ÿæˆå¦ä¸€ä¸ªå¹³å°ï¼ˆç§°ä¸ºç›®æ ‡ï¼‰ä¸Šè¿è¡Œçš„ä»£ç ã€‚ä¾‹å¦‚ï¼Œæœ¬æ–‡çš„èƒŒæ™¯æ˜¯åœ¨macOSä¸Šç¼–è¯‘ä¸€ä¸ªLinuxå¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>
<p>åœ¨è¿™ä¸ªèƒŒæ™¯ä¸‹ï¼Œä¸»æœºæ˜¯x86_64æ¶æ„çš„macOSï¼Œç›®æ ‡æ˜¯x86_64æ¶æ„çš„Linuxã€‚å› æ­¤éœ€è¦ä¸€ä¸ªäº¤å‰ç¼–è¯‘å™¨ï¼Œè¿™ä¸ªç¼–è¯‘å™¨åœ¨macOSä¸Šè¿è¡Œï¼Œä½†ç¼–è¯‘ç”Ÿæˆçš„ä»£ç æ˜¯ä¸ºLinuxå‡†å¤‡çš„ï¼Œä¸èƒ½åœ¨ä¸»æœºä¸Šè¿è¡Œã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„æ­¥éª¤ï¼Œè¯´æ˜å¦‚ä½•åœ¨macOSä¸Šäº¤å‰ç¼–è¯‘Linuxå¯æ‰§è¡Œæ–‡ä»¶ï¼š</p>
<ol>
<li><p><strong>æ„å»ºäº¤å‰ç¼–è¯‘å™¨</strong>ï¼šéœ€è¦é€šè¿‡ä¸€äº›é€”å¾„æ„å»ºä¸»æœºä¸Šçš„äº¤å‰ç¼–è¯‘å·¥å…·ï¼Œä¾‹å¦‚<code>x86_64-linux-gnu-gcc</code>ã€‚</p>
</li>
<li><p><strong>ç¼–å†™ä»£ç </strong>ï¼šåƒå¹³æ—¶ä¸€æ ·ç¼–å†™ä½ çš„Cæˆ–C++ä»£ç ï¼Œä»£ç åº”è¯¥ä¸ä¾èµ–äºä»»ä½•ç‰¹å®šäºmacOSçš„ç‰¹æ€§æˆ–åº“ï¼Œå› ä¸ºè¿™äº›åœ¨Linuxä¸Šå¯èƒ½ä¸å­˜åœ¨ã€‚</p>
</li>
<li><p><strong>ç¼–è¯‘ä»£ç </strong>ï¼šä½¿ç”¨äº¤å‰ç¼–è¯‘å™¨æ¥ç¼–è¯‘ä½ çš„ä»£ç ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥ç¼–è¯‘ä¸€ä¸ªåä¸º<code>hello.c</code>çš„Cç¨‹åºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x86_64-linux-gnu-gcc -o hello hello.c</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‘½ä»¤ä¼šç”Ÿæˆä¸€ä¸ªåä¸º<code>hello</code>çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>
</li>
<li><p><strong>æµ‹è¯•ä»£ç </strong>ï¼šä½ å¯ä»¥æŠŠç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶å¤åˆ¶åˆ°ä¸€ä¸ªLinuxæœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥æ˜¯è™šæ‹Ÿæœºæˆ–Dockerï¼Œç„¶åè¿è¡Œå®ƒæ¥æµ‹è¯•ã€‚</p>
</li>
</ol>
<p>è¿™åªæ˜¯ä¸€ä¸ªåŸºæœ¬çš„ä»‹ç»ã€‚äº¤å‰ç¼–è¯‘å¯èƒ½ä¼šæ¶‰åŠåˆ°æ›´å¤æ‚çš„é—®é¢˜ï¼Œä¾‹å¦‚å¤„ç†åº“ä¾èµ–ã€è°ƒè¯•å’Œä¼˜åŒ–ç­‰ã€‚ä»¥ä¸‹ä¸»è¦ä»‹ç»çš„æ˜¯è¿™é‡Œçš„ç¬¬ä¸€æ­¥ï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•æ„å»ºäº¤å‰ç¼–è¯‘å·¥å…·ã€‚</p>
<h1 id="æ­¥éª¤ä¸€-å®‰è£…æ„å»ºäº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„å·¥å…·"><a href="#æ­¥éª¤ä¸€-å®‰è£…æ„å»ºäº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„å·¥å…·" class="headerlink" title="æ­¥éª¤ä¸€ å®‰è£…æ„å»ºäº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„å·¥å…·"></a>æ­¥éª¤ä¸€ å®‰è£…æ„å»ºäº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„å·¥å…·</h1><p>åœ¨macOSä¸Šï¼ŒHomebrewæ˜¯å¸¸ç”¨çš„åŒ…ç®¡ç†å·¥å…·ã€‚å®‰è£…Homebrew(<code>brew</code>)éœ€è¦è¿è¡Œçš„å‘½ä»¤å¦‚ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/bin/bash -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡<code>brew</code>å®‰è£…macOSä¸‹ç”¨äºæ„å»ºäº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„å·¥å…·<code>crosstool-ng</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install crosstool-ng</span><br></pre></td></tr></table></figure>
<p>å¦å¤–ä¹Ÿå¯ä»¥ä»æºä»£ç æ„å»ºï¼Œæºä»£ç ç¼–è¯‘æ—¶å¯ä»¥æœ‰æ›´å¤šçš„ç¼–è¯‘é€‰é¡¹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/crosstool-ng/crosstool-ng.git</span><br><span class="line"><span class="built_in">cd</span> crosstool-ng</span><br><span class="line">./bootstrap</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ä»<code>crosstool-ng</code>çš„<a href="https://crosstool-ng.github.io">å®˜ç½‘é“¾æ¥</a>æŸ¥çœ‹æ›´å¤šä½¿ç”¨ç»†èŠ‚å’Œæºä»£ç æ„å»ºç»†èŠ‚ã€‚</p>
<p>å®‰è£…æˆ–ç¼–è¯‘æ„å»ºå®Œæˆåï¼Œå¯ä»¥é€šè¿‡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ct-ng --version</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸã€‚</p>
<h1 id="æ­¥éª¤äºŒ-æ„å»ºåŒºåˆ†å¤§å°å†™çš„æ–‡ä»¶ç³»ç»Ÿ"><a href="#æ­¥éª¤äºŒ-æ„å»ºåŒºåˆ†å¤§å°å†™çš„æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æ­¥éª¤äºŒ æ„å»ºåŒºåˆ†å¤§å°å†™çš„æ–‡ä»¶ç³»ç»Ÿ"></a>æ­¥éª¤äºŒ æ„å»ºåŒºåˆ†å¤§å°å†™çš„æ–‡ä»¶ç³»ç»Ÿ</h1><p>è¿™ä¸€æ­¥ä¸»è¦æ˜¯é’ˆå¯¹macOSç³»ç»Ÿè€Œè¨€ã€‚åœ¨ macOSä¸Šï¼Œé»˜è®¤æƒ…å†µä¸‹æ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œè¿™æ„å‘³ç€æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„åç§°å¯¹å¤§å°å†™ä¸æ•æ„Ÿã€‚è¿™æ˜¯`macOS æ–‡ä»¶ç³»ç»Ÿçš„é»˜è®¤è¡Œä¸ºï¼Œç§°ä¸ºä¸åŒºåˆ†å¤§å°å†™çš„æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<p>æ‰¾åˆ°ä¸€ä¸ªæƒ³è¦å­˜æ”¾æ–‡ä»¶ç³»ç»Ÿé•œåƒçš„ç›®å½•ï¼Œè¿è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hdiutil create -size 20g -fs JHFS+X -volname MyCaseSensitiveDisk -<span class="built_in">type</span> SPARSE -layout NONE -attach MyCaseSensitiveDisk.sparseimage</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ª<code>bash</code>å‘½ä»¤ä½¿ç”¨ <code>hdiutil</code> å·¥å…·åˆ›å»ºäº†ä¸€ä¸ªå¤§å°ä¸º 20GBã€æ–‡ä»¶ç³»ç»Ÿä¸ºJHFS+Xï¼ˆåŒºåˆ†å¤§å°å†™çš„HFS+æ–‡ä»¶ç³»ç»Ÿï¼‰ã€å·æ ‡ä¸º<code>MyCaseSensitiveDisk</code>ã€ç±»å‹ä¸º SPARSE çš„ sparseimage æ–‡ä»¶ã€‚sparseimageæ˜¯ä¸€ç§ç¨€ç–æ˜ åƒï¼Œå®ƒåªå ç”¨å®é™…ä½¿ç”¨çš„ç£ç›˜ç©ºé—´ã€‚</p>
<p>æ¥ä¸‹æ¥è¦å°†è¿™ä¸ªæ–‡ä»¶æŒ‚è½½åˆ°ç³»ç»Ÿä¸­</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hdiutil attach MyCaseSensitiveDisk.sparseimage</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œè¿™ä¸ªå‘½ä»¤åï¼Œåº”è¯¥èƒ½å¤Ÿåœ¨ <code>/Volumes</code> ç›®å½•ä¸‹çœ‹åˆ°ä¸€ä¸ªæ–°çš„ç›®å½•ï¼Œå…¶åç§°ä¸ºä½ ä¹‹å‰æŒ‡å®šçš„å·æ ‡ï¼Œä¹Ÿå°±æ˜¯ <code>MyCaseSensitiveDisk</code>ã€‚ä½ å¯ä»¥é€šè¿‡è¿™ä¸ªç›®å½•è®¿é—®æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶å’Œç›®å½•ã€‚</p>
<p>è¯·è®°ä½ï¼Œåœ¨ä½¿ç”¨åŒºåˆ†å¤§å°å†™çš„æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œæ–‡ä»¶å’Œç›®å½•çš„åç§°æ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚å› æ­¤ï¼Œ<code>/Volumes/MyCaseSensitiveDisk</code> å’Œ <code>/Volumes/mycasesensitivedisk</code> æ˜¯ä¸åŒçš„è·¯å¾„ã€‚</p>
<h1 id="æ­¥éª¤ä¸‰-é…ç½®crosstool-ng"><a href="#æ­¥éª¤ä¸‰-é…ç½®crosstool-ng" class="headerlink" title="æ­¥éª¤ä¸‰ é…ç½®crosstool-ng"></a>æ­¥éª¤ä¸‰ é…ç½®crosstool-ng</h1><p>1ã€åœ¨æŒ‚è½½çš„æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼Œç”¨äºä¿å­˜äº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„é…ç½®å’Œè¾“å‡ºã€‚ä¾‹å¦‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> my_toolchain</span><br><span class="line"><span class="built_in">cd</span> my_toolchain</span><br></pre></td></tr></table></figure>
<p>2ã€è¿è¡Œç”Ÿæˆé…ç½®æ–‡ä»¶ ï¼Œé€‰æ‹©ç›®æ ‡å’Œå·¥å…·é“¾é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ct-ng menuconfig</span><br></pre></td></tr></table></figure>
<p>è¿™ä¼šå¯åŠ¨ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢ï¼Œè®©ä½ é…ç½®äº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„å„ä¸ªæ–¹é¢ï¼ŒåŒ…æ‹¬ç›®æ ‡æ¶æ„ã€å·¥å…·é“¾ç‰ˆæœ¬ç­‰ã€‚å»ºè®®åœ¨crosstool-ngçš„å®˜ç½‘æŸ¥è¯¢å„é¡¹é…ç½®çš„ç»†èŠ‚ã€‚æ­¤æ—¶åœ¨ç›®å½•ä¸‹ä¼šç”Ÿæˆ<code>.config</code>çš„æ–‡ä»¶ã€‚</p>
<p>3ã€åœ¨å®Œæˆé…ç½®åï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å¼€å§‹æ„å»ºå·¥å…·é“¾ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ct-ng build</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€æ­¥æ—¶é—´ä¼šæ¯”è¾ƒé•¿ï¼Œè€Œä¸”ç”±äºAbstract Machineç”¨äº†<code>multilib</code>å…¼å®¹äº†32ä½ç³»ç»Ÿï¼Œç”¨<code>crosstool-ng</code>æ„å»º<code>multilib</code>æ—¶ä¼šèŠ±è´¹æ›´å¤šæ—¶é—´ï¼Œå¦å¤–åœ¨æœ¬äººæ„å»º<code>multilib</code>æ—¶ï¼Œç¼–è¯‘è¿‡ç¨‹å‘ç”Ÿäº†ä¸€äº›bugï¼Œè¯¦æƒ…å¯è§è¿™ä¸ªissueï¼š<a href="https://github.com/crosstool-ng/crosstool-ng/issues/2068">Build failed in step &#39;Installing core C gcc compiler&#39; Â· Issue #2068 Â· crosstool-ng/crosstool-ng Â· GitHub</a>ã€‚</p>
<p>4ã€æœ€åï¼Œå°†æ„å»ºçš„äº¤å‰ç¼–è¯‘å·¥å…·é“¾å¤åˆ¶åˆ°æœ¬åœ°ç›®å½•ã€‚æ³¨æ„ï¼Œç”±äºä¾èµ–ï¼Œéœ€è¦å°†æ„å»ºçš„æ•´ä¸ª<code>x-tools</code>æ–‡ä»¶å¤¹å¤åˆ¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">cp</span> -r /Volumes/MyCaseSensitiveDisk/x-tools/ /path/to/my_directory</span><br></pre></td></tr></table></figure>
<p>å¤åˆ¶å®Œä¹‹åå³å¯å¼¹å‡ºç£ç›˜</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hdiutil eject /Volumes/MyCaseSensitiveDisk</span><br></pre></td></tr></table></figure>
<p>5ã€æœ€åï¼Œä½ å¯ä»¥åœ¨ <code>my_toolchain/build</code> ç›®å½•ä¸‹æ‰¾åˆ°ç”Ÿæˆçš„äº¤å‰ç¼–è¯‘å·¥å…·é“¾ã€‚å°†å®ƒæ·»åŠ åˆ°ç³»ç»Ÿçš„ <code>PATH</code> ä¸­ï¼Œä»¥ä¾¿åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/path/to/my_toolchain/build/bin</span><br></pre></td></tr></table></figure>
<h1 id="æ­¥éª¤å››-é¡¹ç›®ç¼–è¯‘å·¥å…·é“¾"><a href="#æ­¥éª¤å››-é¡¹ç›®ç¼–è¯‘å·¥å…·é“¾" class="headerlink" title="æ­¥éª¤å›› é¡¹ç›®ç¼–è¯‘å·¥å…·é“¾"></a>æ­¥éª¤å›› é¡¹ç›®ç¼–è¯‘å·¥å…·é“¾</h1><p>åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œè¿›å…¥<code>os-workbench/kernel</code>ç›®å½•ï¼Œè¿è¡Œ<code>make</code>ç›¸å…³å‘½ä»¤å³å¯ï¼Œéœ€è¦æ³¨æ„åœ¨<code>Makefile</code>ä¸­ï¼Œéœ€è¦ä½¿ç”¨äº¤å‰ç¼–è¯‘å·¥å…·é“¾ï¼Œè€Œä¸æ˜¯æœ¬åœ°ç¼–è¯‘å·¥å…·é“¾çš„è‡³å°‘åŒ…æ‹¬ä½†ä¸é™äº</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">AR        = <span class="variable">$(CROSS_COMPILE)</span>ar</span><br><span class="line">AS        = <span class="variable">$(CROSS_COMPILE)</span>gcc</span><br><span class="line">CC        = <span class="variable">$(CROSS_COMPILE)</span>gcc</span><br><span class="line">CXX       = <span class="variable">$(CROSS_COMPILE)</span>g++</span><br><span class="line">LD        = <span class="variable">$(CROSS_COMPILE)</span>ld</span><br><span class="line">OBJDUMP   = <span class="variable">$(CROSS_COMPILE)</span>objdump</span><br><span class="line">OBJCOPY   = <span class="variable">$(CROSS_COMPILE)</span>objcopy</span><br><span class="line">READELF   = <span class="variable">$(CROSS_COMPILE)</span>readelf</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå°±æ˜¯MacOSç³»ç»Ÿä¸‹æ„å»ºx86_64-linuxäº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„è®°å½•ã€‚</p>
]]></content>
      <categories>
        <category>Tech</category>
      </categories>
      <tags>
        <tag>Cross Compilation</tag>
      </tags>
  </entry>
  <entry>
    <title>Linuxä¸‹musl-libcçš„å®‰è£…</title>
    <url>/2023/11/16/musl-libc/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>Linuxä¸‹é»˜è®¤çš„cæ ‡å‡†åº“æ˜¯glibcï¼Œglibcæ˜¯GNUé¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œç”±äºåœ¨å¾ˆé•¿çš„å†å²å‘å±•ä¸­ï¼Œglibcä¸ºäº†æ€§èƒ½ä¼˜åŒ–ã€å…¼å®¹æ€§é—®é¢˜ï¼ŒåŠ å…¥äº†å¾ˆå¤šå¤æ‚çš„æ±‡ç¼–ä¼˜åŒ–åŠå†—ä½™ä»£ç ï¼Œå› æ­¤å¯è¯»æ€§ä¸é«˜ï¼Œåœ¨ä¸€äº›ç¨‹åº¦ä¸Šä¸åˆ©äºæ–°æ‰‹å¯¹libcçš„å­¦ä¹ ã€‚ä¸æ­¤åŒæ—¶ï¼Œç›®å‰æœ‰å¾ˆå¤šå¼€æºçš„libcä»£ç ï¼Œç”±äºæ²¡æœ‰å†å²åŒ…è¢±ï¼Œå› æ­¤å¯è¯»æ€§éå¸¸é«˜ã€‚ä¸‹é¢ä»¥<code>printf</code>çš„å®ç°ä¸ºä¾‹ï¼Œå±•ç¤ºmusl libcçš„å®ç°ã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in printf.c 1.2.4</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">printf</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *<span class="keyword">restrict</span> fmt, ...)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> ret;</span><br><span class="line">    va_list ap;</span><br><span class="line">    va_start(ap, fmt);</span><br><span class="line">    ret = <span class="built_in">vfprintf</span>(<span class="built_in">stdout</span>, fmt, ap);</span><br><span class="line">    va_end(ap);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in vprintf.c 1.2.4</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">vfprintf</span><span class="params">(FILE *<span class="keyword">restrict</span> f, <span class="type">const</span> <span class="type">char</span> *<span class="keyword">restrict</span> fmt, va_list ap)</span></span><br><span class="line">&#123;</span><br><span class="line">    va_list ap2;</span><br><span class="line">    <span class="type">int</span> nl_type[NL_ARGMAX+<span class="number">1</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="class"><span class="keyword">union</span> <span class="title">arg</span> <span class="title">nl_arg</span>[<span class="title">NL_ARGMAX</span>+1];</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> internal_buf[<span class="number">80</span>], *saved_buf = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> olderr;</span><br><span class="line">    <span class="type">int</span> ret;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* the copy allows passing va_list* even if va_list is an array */</span></span><br><span class="line">    va_copy(ap2, ap);</span><br><span class="line">    <span class="keyword">if</span> (printf_core(<span class="number">0</span>, fmt, &amp;ap2, nl_arg, nl_type) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        va_end(ap2);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    FLOCK(f);</span><br><span class="line">    olderr = f-&gt;flags &amp; F_ERR;</span><br><span class="line">    f-&gt;flags &amp;= ~F_ERR;</span><br><span class="line">    <span class="keyword">if</span> (!f-&gt;buf_size) &#123;</span><br><span class="line">        saved_buf = f-&gt;buf;</span><br><span class="line">        f-&gt;buf = internal_buf;</span><br><span class="line">        f-&gt;buf_size = <span class="keyword">sizeof</span> internal_buf;</span><br><span class="line">        f-&gt;wpos = f-&gt;wbase = f-&gt;wend = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!f-&gt;wend &amp;&amp; __towrite(f)) ret = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">else</span> ret = printf_core(f, fmt, &amp;ap2, nl_arg, nl_type);</span><br><span class="line">    <span class="keyword">if</span> (saved_buf) &#123;</span><br><span class="line">        f-&gt;write(f, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (!f-&gt;wpos) ret = <span class="number">-1</span>;</span><br><span class="line">        f-&gt;buf = saved_buf;</span><br><span class="line">        f-&gt;buf_size = <span class="number">0</span>;</span><br><span class="line">        f-&gt;wpos = f-&gt;wbase = f-&gt;wend = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ferror(f)) ret = <span class="number">-1</span>;</span><br><span class="line">    f-&gt;flags |= olderr;</span><br><span class="line">    FUNLOCK(f);</span><br><span class="line">    va_end(ap2);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="musl-libcç®€ä»‹"><a href="#musl-libcç®€ä»‹" class="headerlink" title="musl libcç®€ä»‹"></a>musl libcç®€ä»‹</h1><p>muslæ˜¯ä¸€ä¸ªCæ ‡å‡†åº“ï¼Œä¸»è¦ç”¨äºåŸºäºLinuxå†…æ ¸çš„æ“ä½œç³»ç»Ÿï¼Œä½¿ç”¨MITè®¸å¯è¯å‘å¸ƒã€‚å®ƒç”±RichFelkerå¼€å‘ï¼Œç›®æ ‡æ˜¯ç¼–å†™ä¸€ä¸ªå¹²å‡€ã€é«˜æ•ˆã€ç¬¦åˆæ ‡å‡†çš„libcå®ç°ã€‚</p>
<p>å®˜æ–¹ç½‘å€ï¼š<a href="http://musl.libc.org/">http://musl.libc.org</a></p>
<p>å‚è€ƒæ–‡æ¡£ï¼š<a href="http://musl.libc.org/manual.html">musl libc Reference Manual</a></p>
<p>muslæ›´å¤šä»‹ç»ï¼š<a href="http://musl.libc.org/about.html">About musl</a></p>
<p>éœ€è¦æ³¨æ„ï¼Œç›®å‰musl libcéœ€è¦åœ¨Linuxå†…æ ¸çš„ç³»ç»Ÿä¸Šé…ç½®ã€‚</p>
<h1 id="musl-libcå®‰è£…è¿‡ç¨‹"><a href="#musl-libcå®‰è£…è¿‡ç¨‹" class="headerlink" title="musl libcå®‰è£…è¿‡ç¨‹"></a>musl libcå®‰è£…è¿‡ç¨‹</h1><h2 id="æ–¹å¼ä¸€ï¼šé€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…"><a href="#æ–¹å¼ä¸€ï¼šé€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…" class="headerlink" title="æ–¹å¼ä¸€ï¼šé€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…"></a>æ–¹å¼ä¸€ï¼šé€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…</h2><p>Linuxçš„å„å‘è¡Œç‰ˆæœ¬ä¸­ä¸€èˆ¬æœ‰é»˜è®¤çš„åŒ…ç®¡ç†å™¨ï¼Œä¾‹å¦‚åœ¨Ubuntuä¸‹ï¼Œå¯ä»¥é€šè¿‡è¿è¡Œå‘½ä»¤å®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install -y musl musl-dev</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å®Œä¹‹åï¼Œç³»ç»Ÿç¯å¢ƒå˜é‡çš„é…ç½®ç›®å½•ä¸‹ä¼šæœ‰muslçš„ç¼–è¯‘å·¥å…·é“¾</p>
<p>è¿è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">musl-gcc --version</span><br></pre></td></tr></table></figure>
<p>å³å¯ç¡®è®¤å·²ç»æ­£ç¡®å®‰è£…ã€‚</p>
<p>æ­¤å¤–ï¼Œåœ¨Linuxå…¶ä»–å‘è¡Œç‰ˆæœ¬ä¸‹ï¼Œ<code>apk</code>ã€<code>pacman</code>ã€<code>emerge</code>ç­‰ä¹Ÿå¯ä»¥å®‰è£…musl libcã€‚</p>
<h2 id="æ–¹å¼äºŒï¼šæºç ç¼–è¯‘å®‰è£…"><a href="#æ–¹å¼äºŒï¼šæºç ç¼–è¯‘å®‰è£…" class="headerlink" title="æ–¹å¼äºŒï¼šæºç ç¼–è¯‘å®‰è£…"></a>æ–¹å¼äºŒï¼šæºç ç¼–è¯‘å®‰è£…</h2><p>åˆ©ç”¨åŒ…ç®¡ç†å·¥å…·å®‰è£…çš„musl libcä½¿ç”¨çš„éƒ½æ˜¯é»˜è®¤é…ç½®ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰å®‰è£…çš„é…ç½®ï¼Œéœ€è¦é€šè¿‡æºç å®‰è£…ã€‚å¯¹äºæ–°æ‰‹è€Œè¨€ï¼Œé€šè¿‡æºç ç¼–è¯‘å®‰è£…ä¹Ÿèƒ½æ›´åŠ ç†Ÿæ‚‰muslçš„å„ç±»åŠŸèƒ½ã€‚</p>
<h3 id="æ­¥éª¤ä¸€-è·å–æºç "><a href="#æ­¥éª¤ä¸€-è·å–æºç " class="headerlink" title="æ­¥éª¤ä¸€ è·å–æºç "></a>æ­¥éª¤ä¸€ è·å–æºç </h3><p>é€šè¿‡gitæ–¹å¼å°†æºç ä¸‹è½½åˆ°æœ¬åœ°</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git://git.musl-libc.org/musl</span><br></pre></td></tr></table></figure>
<p>æˆ–</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://git.musl-libc.org/git/musl</span><br></pre></td></tr></table></figure>
<h3 id="æ­¥éª¤äºŒ-ç¼–è¯‘muslç¯å¢ƒ"><a href="#æ­¥éª¤äºŒ-ç¼–è¯‘muslç¯å¢ƒ" class="headerlink" title="æ­¥éª¤äºŒ ç¼–è¯‘muslç¯å¢ƒ"></a>æ­¥éª¤äºŒ ç¼–è¯‘muslç¯å¢ƒ</h3><p>è¿›å…¥<code>musl</code>æ–‡ä»¶å¤¹ï¼Œåˆ›å»ºå¹¶è¿›å…¥å®‰è£…ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> musl</span><br><span class="line"><span class="built_in">mkdir</span> build &amp;&amp; <span class="built_in">cd</span> build</span><br></pre></td></tr></table></figure>
<h4 id="configureé…ç½®ç¼–è¯‘å‚æ•°"><a href="#configureé…ç½®ç¼–è¯‘å‚æ•°" class="headerlink" title="./configureé…ç½®ç¼–è¯‘å‚æ•°"></a><code>./configure</code>é…ç½®ç¼–è¯‘å‚æ•°</h4><p><code>configure</code>æ–‡ä»¶æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„POSIX shellè„šæœ¬ï¼Œè¿è¡Œåä¼šåœ¨<code>musl</code>ç›®å½•ä¸‹äº§ç”Ÿ<code>config.mak</code>æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å°†ä¼šè¢«<code>Makefile</code>è°ƒç”¨</p>
<p>è¿è¡Œé…ç½®æ–‡ä»¶çš„æ ¼å¼æ˜¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">../configure [OPTION] [VAR=VALUE]</span><br></pre></td></tr></table></figure>
<p><code>[OPTION]</code>å’Œ<code>[VAR=VALUE]</code>å¯ç”¨äºæŒ‡å®šconfigureé…ç½®çš„é€‰é¡¹å’Œå‚æ•°ï¼Œä»¥ä¸‹æ˜¯å¸¸ç”¨çš„ä¾‹å­ï¼š</p>
<ul>
<li><p><code>â€“prefix</code>ï¼Œç”¨äºæŒ‡å®šmuslçš„å®‰è£…ç›®å½•ï¼Œé»˜è®¤æ˜¯<code>/usr/local/musl</code>ï¼Œè€Œä¸æ˜¯<code>/usr/local</code>ï¼Œè¿™æ˜¯ä¸ºäº†é¿å…ä¸ä¸»æœºä¸Šç°æœ‰çš„émuslç¯å¢ƒå†²çªã€‚å¦‚æœæƒ³è¦å®‰è£…muslä½œä¸ºç³»ç»Ÿlibcï¼Œåˆ™å‰ç¼€è®¾ç½®ä¸º<code>/usr</code>æˆ–<code>/</code>ã€‚</p>
</li>
<li><p><code>â€“syslibdir</code>ï¼Œç”¨äºæŒ‡å®šåŠ¨æ€é“¾æ¥å™¨çš„å®‰è£…ä½ç½®ã€‚é»˜è®¤æ˜¯<code>/lib</code>ã€‚</p>
</li>
<li><p><code>CC=â€¦</code>ï¼ŒæŒ‡å®šç¼–è¯‘å™¨ï¼Œé»˜è®¤å°†æ˜¯ç³»ç»Ÿä¸Šé»˜è®¤çš„ç¼–è¯‘å™¨ï¼Œå¦‚<code>gcc</code>ã€‚</p>
</li>
<li><p><code>CFLAGS=â€¦</code>ï¼Œç¼–è¯‘å™¨çš„è‡ªå®šä¹‰é€‰é¡¹ã€‚</p>
</li>
<li><p><code>â€“disable-shared</code>ï¼Œé»˜è®¤ä¸å¼€å¯ï¼Œå¼€å¯åˆ™ç¦ç”¨æ„å»ºå…±äº«çš„<code>libc.so</code>ï¼Œå°†å‡åŠæ„å»ºæ—¶é—´ã€‚</p>
</li>
<li><p><code>â€“disable-static</code>ï¼Œé»˜è®¤ä¸å¼€å¯ï¼Œå¼€å¯åˆ™ç¦ç”¨æ„å»º<code>libc.a</code>ï¼Œä½†å…¶ä»–<code>.a</code>æ–‡ä»¶ä»ç„¶è¢«æ„å»ºã€‚è¿™ä¹Ÿå°†å‡åŠæ„å»ºæ—¶é—´ã€‚</p>
</li>
<li><p><code>â€“enable-warnings</code>ï¼Œæ‰“å¼€æ¨èçš„GCCè­¦å‘Šé€‰é¡¹é›†ï¼Œmuslæ—¨åœ¨ç¼–è¯‘æ— è­¦å‘Šã€‚</p>
</li>
<li><p><code>â€“enable-debug</code>ï¼Œæ‰“å¼€è°ƒè¯•ã€‚åœ¨<code>CFLAGS</code>ä¸­æ‰‹åŠ¨æ·»åŠ <code>-g</code>ä¹Ÿå¯ä»¥ã€‚åœ¨æœªæ¥ï¼Œ<code>â€“enable-debug</code>å¯èƒ½è¿˜ä¼šåœ¨æºä»£ç çº§åˆ«å¯ç”¨é¢å¤–çš„è°ƒè¯•åŠŸèƒ½ã€‚è¿™ä¸€é¡¹è°ƒè¯•ç¨‹åºæ—¶æœ‰æ˜¾è‘—çš„ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œå½“ä½¿ç”¨<code>gdb</code>è°ƒè¯•ä¸€ä¸ªcç¨‹åºæ—¶ï¼Œå¦‚æœåœ¨ç¼–è¯‘è¿‡ç¨‹åŠ å…¥<code>-g</code>é€‰é¡¹ï¼Œ<code>gdb</code>è°ƒè¯•ä»…ä»…åªèƒ½åœ¨å½“å‰ç¼–è¯‘çš„cæ–‡ä»¶ä¸­è°ƒè¯•ï¼Œè€Œä¸èƒ½è°ƒè¯•è¿›å…¥cçš„åº“å‡½æ•°ç¨‹åºã€‚å¦‚æœåŠ å…¥è¿™ä¸€é€‰é¡¹ï¼Œè°ƒè¯•è¿‡ç¨‹å¯ä»¥æ·±å…¥åº“å‡½æ•°å†…éƒ¨ï¼ˆä¾‹å¦‚<code>printf</code>ã€<code>malloc</code>ç­‰ï¼‰ï¼Œäº†è§£ç¨‹åºæ¯ä¸€æ­¥çš„è¿è¡Œçš„çŠ¶æ€ã€‚</p>
</li>
</ul>
<p>è¿è¡Œ<code>../configure --help</code>å¯ä»¥çœ‹åˆ°configureé…ç½®çš„æ›´å¤šå‚æ•°ã€‚</p>
<h4 id="ä½¿ç”¨makeè¿›è¡Œç¼–è¯‘å®‰è£…"><a href="#ä½¿ç”¨makeè¿›è¡Œç¼–è¯‘å®‰è£…" class="headerlink" title="ä½¿ç”¨makeè¿›è¡Œç¼–è¯‘å®‰è£…"></a>ä½¿ç”¨makeè¿›è¡Œç¼–è¯‘å®‰è£…</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
<p><code>sudo</code>éœ€è¦è¾“å…¥ç”¨æˆ·å¯†ç ï¼Œå®‰è£…å®Œæˆåä¼šåœ¨æŒ‡å®šçš„å®‰è£…ç›®å½•ç”Ÿæˆmuslçš„ç¼–è¯‘å·¥å…·é“¾ã€‚å¦‚æœå®‰è£…ç›®å½•ä¸åœ¨ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­ï¼Œéœ€è¦é…ç½®ç¯å¢ƒå˜é‡ã€‚</p>
<h3 id="æ­¥éª¤ä¸‰-ç”¨muslç¼–è¯‘ç¨‹åº"><a href="#æ­¥éª¤ä¸‰-ç”¨muslç¼–è¯‘ç¨‹åº" class="headerlink" title="æ­¥éª¤ä¸‰ ç”¨muslç¼–è¯‘ç¨‹åº"></a>æ­¥éª¤ä¸‰ ç”¨muslç¼–è¯‘ç¨‹åº</h3><p>ä»¥ç¼–è¯‘cç¨‹åºä¸ºä¾‹ï¼Œ<code>musl-gcc</code>å’Œ<code>gcc</code>ä¸€æ ·å¯ä»¥ç¼–è¯‘cç¨‹åºã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&#x27;Hello World!&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">musl-gcc hello.c &amp;&amp; ./a.out <span class="comment"># Hello World!</span></span><br></pre></td></tr></table></figure>
<p>å°†è¾“å‡º<code>Hello World!</code>çš„ç»“æœã€‚</p>
]]></content>
      <categories>
        <category>Tech</category>
      </categories>
      <tags>
        <tag>libc</tag>
      </tags>
  </entry>
  <entry>
    <title>MacOSç³»ç»Ÿé€šè¿‡musl-crossäº¤å‰ç¼–è¯‘</title>
    <url>/2023/11/16/musl-cross/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¸Šä¸€ç¯‡åšå®¢<a href="/2023/11/15/cross-compilation-on-MacOS">MacOSç³»ç»Ÿä¸‹x86_64-linuxäº¤å‰ç¼–è¯‘è®°å½•</a>è®¨è®ºäº†é€šè¿‡<code>crosstool-ng</code>æ„å»ºäº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„æµç¨‹ï¼Œäº‹å®ä¸Šï¼Œåœ¨MacOSå’ŒWindowså¹³å°ä¸Šï¼Œæœ‰ä¸€äº›å·²ç»æ„å»ºå¥½çš„å·¥å…·é“¾å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p>
<h1 id="musl-cross-make"><a href="#musl-cross-make" class="headerlink" title="musl-cross-make"></a>musl-cross-make</h1><p>musl-cross-make(<a href="https://words.filippo.io/easy-windows-and-linux-cross-compilers-for-macos/">EASY WINDOWS AND LINUX CROSS-COMPILERS FOR MACOS</a>)æ˜¯åŸºäº<a href="http://www.musl-libc.org/">musl</a>åº“çš„äº¤å‰ç¼–è¯‘å™¨ï¼Œåœ¨åŠŸèƒ½ä¸Šä¸<code>crosstool-ng</code>æ„å»ºçš„<code>x86_64-linux-gnu-</code>å·¥å…·ç›¸åŒã€‚muslåŸæœ¬æ˜¯Linuxä¸‹çš„ä¸€ä¸ªç¼–è¯‘å·¥å…·ï¼Œå…·ä½“å¯ä»¥å‚è§<a href="/2023/11/16/musl-libc">Linuxä¸‹musl-libcçš„å®‰è£…</a>ã€‚</p>
<p>musl-cross-makeåœ¨macOSä¸Šä¹Ÿå¯ä»¥é€šè¿‡<code>brew</code>å®‰è£…ã€‚ä»macOSç¼–è¯‘C/C++ä»£ç åˆ°Linuxå¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªHomebrewåŒ…æ¥å®ç°ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install FiloSottile/musl-cross/musl-cross</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¦ä»æºä»£ç æ„å»ºï¼Œå¯ä»¥è¿è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install --build-from-source FiloSottile/musl-cross/musl-cross</span><br></pre></td></tr></table></figure>
<p>musl-cross-makeåŒæ ·æ”¯æŒarmæ¶æ„ï¼Œå¦‚æœéœ€è¦äº¤å‰ç¼–è¯‘åˆ°armæ¶æ„çš„æœºå™¨ä¸Šè¿è¡Œï¼Œä¾‹å¦‚æ ‘è“æ´¾ï¼Œå¯ä»¥è¿è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install FiloSottile/musl-cross/musl-cross --without-x86_64 --with-arm-hf</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±ä¼šåœ¨Homebrewé»˜è®¤çš„å®‰è£…è·¯å¾„ä¸‹æ„å»ºå®Œæˆmusl-cross-makeçš„äº¤å‰ç¼–è¯‘å·¥å…·ã€‚</p>
<h1 id="mingw-w64"><a href="#mingw-w64" class="headerlink" title="mingw-w64"></a>mingw-w64</h1><p>ä»macOSç¼–è¯‘C/C++ä»£ç åˆ°Windowsä¹Ÿæœ‰HomebrewåŒ…å®ç°ï¼Œå¯ä»¥å¦‚ä¸‹å®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install mingw-w64</span><br></pre></td></tr></table></figure>
<h1 id="äº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„ä½¿ç”¨"><a href="#äº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„ä½¿ç”¨" class="headerlink" title="äº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„ä½¿ç”¨"></a>äº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„ä½¿ç”¨</h1><p>é€šè¿‡<code>brew</code>å®‰è£…å®Œåï¼Œé»˜è®¤ç›®å½•<code>usr/local/bin</code>ä¸‹ä¼šå­˜åœ¨ç¼–è¯‘å·¥å…·ï¼Œä»¥x86_64çš„musl-cross-makeç¼–è¯‘<code>.c</code>æ–‡ä»¶ä¸ºä¾‹ï¼Œé€šè¿‡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x86_64-linux-musl-gcc [input.c] [-CFLAGS]</span><br></pre></td></tr></table></figure>
<p>å³å¯ç¼–è¯‘ç”Ÿæˆx86_64-linuxä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶</p>
]]></content>
      <categories>
        <category>Tech</category>
      </categories>
      <tags>
        <tag>Cross Compilation</tag>
      </tags>
  </entry>
</search>
